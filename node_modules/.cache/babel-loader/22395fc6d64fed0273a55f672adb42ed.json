{"ast":null,"code":"/*!\n * better-scroll / core\n * (c) 2016-2021 ustbhuangyi\n * Released under the MIT License.\n */\n\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\n\n/* global Reflect, Promise */\nvar extendStatics = function (d, b) {\n  extendStatics = Object.setPrototypeOf || {\n    __proto__: []\n  } instanceof Array && function (d, b) {\n    d.__proto__ = b;\n  } || function (d, b) {\n    for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n  };\n\n  return extendStatics(d, b);\n};\n\nfunction __extends(d, b) {\n  extendStatics(d, b);\n\n  function __() {\n    this.constructor = d;\n  }\n\n  d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n}\n\nvar __assign = function () {\n  __assign = Object.assign || function __assign(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nfunction __spreadArrays() {\n  for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n\n  for (var r = Array(s), k = 0, i = 0; i < il; i++) for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++) r[k] = a[j];\n\n  return r;\n}\n\nvar propertiesConfig = [{\n  sourceKey: 'scroller.scrollBehaviorX.currentPos',\n  key: 'x'\n}, {\n  sourceKey: 'scroller.scrollBehaviorY.currentPos',\n  key: 'y'\n}, {\n  sourceKey: 'scroller.scrollBehaviorX.hasScroll',\n  key: 'hasHorizontalScroll'\n}, {\n  sourceKey: 'scroller.scrollBehaviorY.hasScroll',\n  key: 'hasVerticalScroll'\n}, {\n  sourceKey: 'scroller.scrollBehaviorX.contentSize',\n  key: 'scrollerWidth'\n}, {\n  sourceKey: 'scroller.scrollBehaviorY.contentSize',\n  key: 'scrollerHeight'\n}, {\n  sourceKey: 'scroller.scrollBehaviorX.maxScrollPos',\n  key: 'maxScrollX'\n}, {\n  sourceKey: 'scroller.scrollBehaviorY.maxScrollPos',\n  key: 'maxScrollY'\n}, {\n  sourceKey: 'scroller.scrollBehaviorX.minScrollPos',\n  key: 'minScrollX'\n}, {\n  sourceKey: 'scroller.scrollBehaviorY.minScrollPos',\n  key: 'minScrollY'\n}, {\n  sourceKey: 'scroller.scrollBehaviorX.movingDirection',\n  key: 'movingDirectionX'\n}, {\n  sourceKey: 'scroller.scrollBehaviorY.movingDirection',\n  key: 'movingDirectionY'\n}, {\n  sourceKey: 'scroller.scrollBehaviorX.direction',\n  key: 'directionX'\n}, {\n  sourceKey: 'scroller.scrollBehaviorY.direction',\n  key: 'directionY'\n}, {\n  sourceKey: 'scroller.actions.enabled',\n  key: 'enabled'\n}, {\n  sourceKey: 'scroller.animater.pending',\n  key: 'pending'\n}, {\n  sourceKey: 'scroller.animater.stop',\n  key: 'stop'\n}, {\n  sourceKey: 'scroller.scrollTo',\n  key: 'scrollTo'\n}, {\n  sourceKey: 'scroller.scrollBy',\n  key: 'scrollBy'\n}, {\n  sourceKey: 'scroller.scrollToElement',\n  key: 'scrollToElement'\n}, {\n  sourceKey: 'scroller.resetPosition',\n  key: 'resetPosition'\n}];\n\nfunction warn(msg) {\n  console.error(\"[BScroll warn]: \" + msg);\n} // ssr support\n\n\nvar inBrowser = typeof window !== 'undefined';\nvar ua = inBrowser && navigator.userAgent.toLowerCase();\nvar isWeChatDevTools = !!(ua && /wechatdevtools/.test(ua));\nvar isAndroid = ua && ua.indexOf('android') > 0;\n/* istanbul ignore next */\n\nvar isIOSBadVersion = function () {\n  if (typeof ua === 'string') {\n    var regex = /os (\\d\\d?_\\d(_\\d)?)/;\n    var matches = regex.exec(ua);\n    if (!matches) return false;\n    var parts = matches[1].split('_').map(function (item) {\n      return parseInt(item, 10);\n    }); // ios version >= 13.4 issue 982\n\n    return !!(parts[0] === 13 && parts[1] >= 4);\n  }\n\n  return false;\n}();\n/* istanbul ignore next */\n\n\nvar supportsPassive = false;\n/* istanbul ignore next */\n\nif (inBrowser) {\n  var EventName = 'test-passive';\n\n  try {\n    var opts = {};\n    Object.defineProperty(opts, 'passive', {\n      get: function () {\n        supportsPassive = true;\n      }\n    }); // https://github.com/facebook/flow/issues/285\n\n    window.addEventListener(EventName, function () {}, opts);\n  } catch (e) {}\n}\n\nfunction getNow() {\n  return window.performance && window.performance.now && window.performance.timing ? window.performance.now() + window.performance.timing.navigationStart : +new Date();\n}\n\nvar extend = function (target, source) {\n  for (var key in source) {\n    target[key] = source[key];\n  }\n\n  return target;\n};\n\nfunction isUndef(v) {\n  return v === undefined || v === null;\n}\n\nfunction between(x, min, max) {\n  if (x < min) {\n    return min;\n  }\n\n  if (x > max) {\n    return max;\n  }\n\n  return x;\n}\n\nvar elementStyle = inBrowser && document.createElement('div').style;\n\nvar vendor = function () {\n  /* istanbul ignore if  */\n  if (!inBrowser) {\n    return false;\n  }\n\n  var transformNames = [{\n    key: 'standard',\n    value: 'transform'\n  }, {\n    key: 'webkit',\n    value: 'webkitTransform'\n  }, {\n    key: 'Moz',\n    value: 'MozTransform'\n  }, {\n    key: 'O',\n    value: 'OTransform'\n  }, {\n    key: 'ms',\n    value: 'msTransform'\n  }];\n\n  for (var _i = 0, transformNames_1 = transformNames; _i < transformNames_1.length; _i++) {\n    var obj = transformNames_1[_i];\n\n    if (elementStyle[obj.value] !== undefined) {\n      return obj.key;\n    }\n  }\n  /* istanbul ignore next  */\n\n\n  return false;\n}();\n/* istanbul ignore next  */\n\n\nfunction prefixStyle(style) {\n  if (vendor === false) {\n    return style;\n  }\n\n  if (vendor === 'standard') {\n    if (style === 'transitionEnd') {\n      return 'transitionend';\n    }\n\n    return style;\n  }\n\n  return vendor + style.charAt(0).toUpperCase() + style.substr(1);\n}\n\nfunction getElement(el) {\n  return typeof el === 'string' ? document.querySelector(el) : el;\n}\n\nfunction addEvent(el, type, fn, capture) {\n  var useCapture = supportsPassive ? {\n    passive: false,\n    capture: !!capture\n  } : !!capture;\n  el.addEventListener(type, fn, useCapture);\n}\n\nfunction removeEvent(el, type, fn, capture) {\n  el.removeEventListener(type, fn, {\n    capture: !!capture\n  });\n}\n\nfunction offset(el) {\n  var left = 0;\n  var top = 0;\n\n  while (el) {\n    left -= el.offsetLeft;\n    top -= el.offsetTop;\n    el = el.offsetParent;\n  }\n\n  return {\n    left: left,\n    top: top\n  };\n}\n\nvendor && vendor !== 'standard' ? '-' + vendor.toLowerCase() + '-' : '';\nvar transform = prefixStyle('transform');\nvar transition = prefixStyle('transition');\nvar hasPerspective = inBrowser && prefixStyle('perspective') in elementStyle; // fix issue #361\n\nvar hasTouch = inBrowser && ('ontouchstart' in window || isWeChatDevTools);\nvar hasTransition = inBrowser && transition in elementStyle;\nvar style = {\n  transform: transform,\n  transition: transition,\n  transitionTimingFunction: prefixStyle('transitionTimingFunction'),\n  transitionDuration: prefixStyle('transitionDuration'),\n  transitionDelay: prefixStyle('transitionDelay'),\n  transformOrigin: prefixStyle('transformOrigin'),\n  transitionEnd: prefixStyle('transitionEnd'),\n  transitionProperty: prefixStyle('transitionProperty')\n};\nvar eventTypeMap = {\n  touchstart: 1,\n  touchmove: 1,\n  touchend: 1,\n  touchcancel: 1,\n  mousedown: 2,\n  mousemove: 2,\n  mouseup: 2\n};\n\nfunction getRect(el) {\n  /* istanbul ignore if  */\n  if (el instanceof window.SVGElement) {\n    var rect = el.getBoundingClientRect();\n    return {\n      top: rect.top,\n      left: rect.left,\n      width: rect.width,\n      height: rect.height\n    };\n  } else {\n    return {\n      top: el.offsetTop,\n      left: el.offsetLeft,\n      width: el.offsetWidth,\n      height: el.offsetHeight\n    };\n  }\n}\n\nfunction preventDefaultExceptionFn(el, exceptions) {\n  for (var i in exceptions) {\n    if (exceptions[i].test(el[i])) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\nvar tagExceptionFn = preventDefaultExceptionFn;\n\nfunction tap(e, eventName) {\n  var ev = document.createEvent('Event');\n  ev.initEvent(eventName, true, true);\n  ev.pageX = e.pageX;\n  ev.pageY = e.pageY;\n  e.target.dispatchEvent(ev);\n}\n\nfunction click(e, event) {\n  if (event === void 0) {\n    event = 'click';\n  }\n\n  var eventSource;\n\n  if (e.type === 'mouseup') {\n    eventSource = e;\n  } else if (e.type === 'touchend' || e.type === 'touchcancel') {\n    eventSource = e.changedTouches[0];\n  }\n\n  var posSrc = {};\n\n  if (eventSource) {\n    posSrc.screenX = eventSource.screenX || 0;\n    posSrc.screenY = eventSource.screenY || 0;\n    posSrc.clientX = eventSource.clientX || 0;\n    posSrc.clientY = eventSource.clientY || 0;\n  }\n\n  var ev;\n  var bubbles = true;\n  var cancelable = true;\n  var ctrlKey = e.ctrlKey,\n      shiftKey = e.shiftKey,\n      altKey = e.altKey,\n      metaKey = e.metaKey;\n  var pressedKeysMap = {\n    ctrlKey: ctrlKey,\n    shiftKey: shiftKey,\n    altKey: altKey,\n    metaKey: metaKey\n  };\n\n  if (typeof MouseEvent !== 'undefined') {\n    try {\n      ev = new MouseEvent(event, extend(__assign({\n        bubbles: bubbles,\n        cancelable: cancelable\n      }, pressedKeysMap), posSrc));\n    } catch (e) {\n      /* istanbul ignore next */\n      createEvent();\n    }\n  } else {\n    createEvent();\n  }\n\n  function createEvent() {\n    ev = document.createEvent('Event');\n    ev.initEvent(event, bubbles, cancelable);\n    extend(ev, posSrc);\n  } // forwardedTouchEvent set to true in case of the conflict with fastclick\n\n\n  ev.forwardedTouchEvent = true;\n  ev._constructed = true;\n  e.target.dispatchEvent(ev);\n}\n\nfunction dblclick(e) {\n  click(e, 'dblclick');\n}\n\nvar ease = {\n  // easeOutQuint\n  swipe: {\n    style: 'cubic-bezier(0.23, 1, 0.32, 1)',\n    fn: function (t) {\n      return 1 + --t * t * t * t * t;\n    }\n  },\n  // easeOutQuard\n  swipeBounce: {\n    style: 'cubic-bezier(0.25, 0.46, 0.45, 0.94)',\n    fn: function (t) {\n      return t * (2 - t);\n    }\n  },\n  // easeOutQuart\n  bounce: {\n    style: 'cubic-bezier(0.165, 0.84, 0.44, 1)',\n    fn: function (t) {\n      return 1 - --t * t * t * t;\n    }\n  }\n};\nvar DEFAULT_INTERVAL = 1000 / 60;\nvar windowCompat = inBrowser && window;\n/* istanbul ignore next */\n\nfunction noop$1() {}\n\nvar requestAnimationFrame = function () {\n  /* istanbul ignore if  */\n  if (!inBrowser) {\n    return noop$1;\n  }\n\n  return windowCompat.requestAnimationFrame || windowCompat.webkitRequestAnimationFrame || windowCompat.mozRequestAnimationFrame || windowCompat.oRequestAnimationFrame || // if all else fails, use setTimeout\n  function (callback) {\n    return window.setTimeout(callback, callback.interval || DEFAULT_INTERVAL); // make interval as precise as possible.\n  };\n}();\n\nvar cancelAnimationFrame = function () {\n  /* istanbul ignore if  */\n  if (!inBrowser) {\n    return noop$1;\n  }\n\n  return windowCompat.cancelAnimationFrame || windowCompat.webkitCancelAnimationFrame || windowCompat.mozCancelAnimationFrame || windowCompat.oCancelAnimationFrame || function (id) {\n    window.clearTimeout(id);\n  };\n}();\n/* istanbul ignore next */\n\n\nvar noop = function (val) {};\n\nvar sharedPropertyDefinition = {\n  enumerable: true,\n  configurable: true,\n  get: noop,\n  set: noop\n};\n\nvar getProperty = function (obj, key) {\n  var keys = key.split('.');\n\n  for (var i = 0; i < keys.length - 1; i++) {\n    obj = obj[keys[i]];\n    if (typeof obj !== 'object' || !obj) return;\n  }\n\n  var lastKey = keys.pop();\n\n  if (typeof obj[lastKey] === 'function') {\n    return function () {\n      return obj[lastKey].apply(obj, arguments);\n    };\n  } else {\n    return obj[lastKey];\n  }\n};\n\nvar setProperty = function (obj, key, value) {\n  var keys = key.split('.');\n  var temp;\n\n  for (var i = 0; i < keys.length - 1; i++) {\n    temp = keys[i];\n    if (!obj[temp]) obj[temp] = {};\n    obj = obj[temp];\n  }\n\n  obj[keys.pop()] = value;\n};\n\nfunction propertiesProxy(target, sourceKey, key) {\n  sharedPropertyDefinition.get = function proxyGetter() {\n    return getProperty(this, sourceKey);\n  };\n\n  sharedPropertyDefinition.set = function proxySetter(val) {\n    setProperty(this, sourceKey, val);\n  };\n\n  Object.defineProperty(target, key, sharedPropertyDefinition);\n}\n\nvar EventEmitter =\n/** @class */\nfunction () {\n  function EventEmitter(names) {\n    this.events = {};\n    this.eventTypes = {};\n    this.registerType(names);\n  }\n\n  EventEmitter.prototype.on = function (type, fn, context) {\n    if (context === void 0) {\n      context = this;\n    }\n\n    this.hasType(type);\n\n    if (!this.events[type]) {\n      this.events[type] = [];\n    }\n\n    this.events[type].push([fn, context]);\n    return this;\n  };\n\n  EventEmitter.prototype.once = function (type, fn, context) {\n    var _this = this;\n\n    if (context === void 0) {\n      context = this;\n    }\n\n    this.hasType(type);\n\n    var magic = function () {\n      var args = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n\n      _this.off(type, magic);\n\n      var ret = fn.apply(context, args);\n\n      if (ret === true) {\n        return ret;\n      }\n    };\n\n    magic.fn = fn;\n    this.on(type, magic);\n    return this;\n  };\n\n  EventEmitter.prototype.off = function (type, fn) {\n    if (!type && !fn) {\n      this.events = {};\n      return this;\n    }\n\n    if (type) {\n      this.hasType(type);\n\n      if (!fn) {\n        this.events[type] = [];\n        return this;\n      }\n\n      var events = this.events[type];\n\n      if (!events) {\n        return this;\n      }\n\n      var count = events.length;\n\n      while (count--) {\n        if (events[count][0] === fn || events[count][0] && events[count][0].fn === fn) {\n          events.splice(count, 1);\n        }\n      }\n\n      return this;\n    }\n  };\n\n  EventEmitter.prototype.trigger = function (type) {\n    var args = [];\n\n    for (var _i = 1; _i < arguments.length; _i++) {\n      args[_i - 1] = arguments[_i];\n    }\n\n    this.hasType(type);\n    var events = this.events[type];\n\n    if (!events) {\n      return;\n    }\n\n    var len = events.length;\n\n    var eventsCopy = __spreadArrays(events);\n\n    var ret;\n\n    for (var i = 0; i < len; i++) {\n      var event_1 = eventsCopy[i];\n      var fn = event_1[0],\n          context = event_1[1];\n\n      if (fn) {\n        ret = fn.apply(context, args);\n\n        if (ret === true) {\n          return ret;\n        }\n      }\n    }\n  };\n\n  EventEmitter.prototype.registerType = function (names) {\n    var _this = this;\n\n    names.forEach(function (type) {\n      _this.eventTypes[type] = type;\n    });\n  };\n\n  EventEmitter.prototype.destroy = function () {\n    this.events = {};\n    this.eventTypes = {};\n  };\n\n  EventEmitter.prototype.hasType = function (type) {\n    var types = this.eventTypes;\n    var isType = types[type] === type;\n\n    if (!isType) {\n      warn(\"EventEmitter has used unknown event type: \\\"\" + type + \"\\\", should be oneof [\" + (\"\" + Object.keys(types).map(function (_) {\n        return JSON.stringify(_);\n      })) + \"]\");\n    }\n  };\n\n  return EventEmitter;\n}();\n\nvar EventRegister =\n/** @class */\nfunction () {\n  function EventRegister(wrapper, events) {\n    this.wrapper = wrapper;\n    this.events = events;\n    this.addDOMEvents();\n  }\n\n  EventRegister.prototype.destroy = function () {\n    this.removeDOMEvents();\n    this.events = [];\n  };\n\n  EventRegister.prototype.addDOMEvents = function () {\n    this.handleDOMEvents(addEvent);\n  };\n\n  EventRegister.prototype.removeDOMEvents = function () {\n    this.handleDOMEvents(removeEvent);\n  };\n\n  EventRegister.prototype.handleDOMEvents = function (eventOperation) {\n    var _this = this;\n\n    var wrapper = this.wrapper;\n    this.events.forEach(function (event) {\n      eventOperation(wrapper, event.name, _this, !!event.capture);\n    });\n  };\n\n  EventRegister.prototype.handleEvent = function (e) {\n    var eventType = e.type;\n    this.events.some(function (event) {\n      if (event.name === eventType) {\n        event.handler(e);\n        return true;\n      }\n\n      return false;\n    });\n  };\n\n  return EventRegister;\n}();\n\nvar CustomOptions =\n/** @class */\nfunction () {\n  function CustomOptions() {}\n\n  return CustomOptions;\n}();\n\nvar OptionsConstructor =\n/** @class */\nfunction (_super) {\n  __extends(OptionsConstructor, _super);\n\n  function OptionsConstructor() {\n    var _this = _super.call(this) || this;\n\n    _this.startX = 0;\n    _this.startY = 0;\n    _this.scrollX = false;\n    _this.scrollY = true;\n    _this.freeScroll = false;\n    _this.directionLockThreshold = 0;\n    _this.eventPassthrough = \"\"\n    /* None */\n    ;\n    _this.click = false;\n    _this.dblclick = false;\n    _this.tap = '';\n    _this.bounce = {\n      top: true,\n      bottom: true,\n      left: true,\n      right: true\n    };\n    _this.bounceTime = 800;\n    _this.momentum = true;\n    _this.momentumLimitTime = 300;\n    _this.momentumLimitDistance = 15;\n    _this.swipeTime = 2500;\n    _this.swipeBounceTime = 500;\n    _this.deceleration = 0.0015;\n    _this.flickLimitTime = 200;\n    _this.flickLimitDistance = 100;\n    _this.resizePolling = 60;\n    _this.probeType = 0\n    /* Default */\n    ;\n    _this.stopPropagation = false;\n    _this.preventDefault = true;\n    _this.preventDefaultException = {\n      tagName: /^(INPUT|TEXTAREA|BUTTON|SELECT|AUDIO)$/\n    };\n    _this.tagException = {\n      tagName: /^TEXTAREA$/\n    };\n    _this.HWCompositing = true;\n    _this.useTransition = true;\n    _this.bindToWrapper = false;\n    _this.bindToTarget = false;\n    _this.disableMouse = hasTouch;\n    _this.disableTouch = !hasTouch;\n    _this.autoBlur = true;\n    _this.autoEndDistance = 5;\n    _this.outOfBoundaryDampingFactor = 1 / 3;\n    _this.specifiedIndexAsContent = 0;\n    _this.quadrant = 1\n    /* First */\n    ;\n    return _this;\n  }\n\n  OptionsConstructor.prototype.merge = function (options) {\n    if (!options) return this;\n\n    for (var key in options) {\n      if (key === 'bounce') {\n        this.bounce = this.resolveBounce(options[key]);\n        continue;\n      }\n\n      this[key] = options[key];\n    }\n\n    return this;\n  };\n\n  OptionsConstructor.prototype.process = function () {\n    this.translateZ = this.HWCompositing && hasPerspective ? ' translateZ(1px)' : '';\n    this.useTransition = this.useTransition && hasTransition;\n    this.preventDefault = !this.eventPassthrough && this.preventDefault; // If you want eventPassthrough I have to lock one of the axes\n\n    this.scrollX = this.eventPassthrough === \"horizontal\"\n    /* Horizontal */\n    ? false : this.scrollX;\n    this.scrollY = this.eventPassthrough === \"vertical\"\n    /* Vertical */\n    ? false : this.scrollY; // With eventPassthrough we also need lockDirection mechanism\n\n    this.freeScroll = this.freeScroll && !this.eventPassthrough; // force true when freeScroll is true\n\n    this.scrollX = this.freeScroll ? true : this.scrollX;\n    this.scrollY = this.freeScroll ? true : this.scrollY;\n    this.directionLockThreshold = this.eventPassthrough ? 0 : this.directionLockThreshold;\n    return this;\n  };\n\n  OptionsConstructor.prototype.resolveBounce = function (bounceOptions) {\n    var DEFAULT_BOUNCE = {\n      top: true,\n      right: true,\n      bottom: true,\n      left: true\n    };\n    var NEGATED_BOUNCE = {\n      top: false,\n      right: false,\n      bottom: false,\n      left: false\n    };\n    var ret;\n\n    if (typeof bounceOptions === 'object') {\n      ret = extend(DEFAULT_BOUNCE, bounceOptions);\n    } else {\n      ret = bounceOptions ? DEFAULT_BOUNCE : NEGATED_BOUNCE;\n    }\n\n    return ret;\n  };\n\n  return OptionsConstructor;\n}(CustomOptions);\n\nvar ActionsHandler =\n/** @class */\nfunction () {\n  function ActionsHandler(wrapper, options) {\n    this.wrapper = wrapper;\n    this.options = options;\n    this.hooks = new EventEmitter(['beforeStart', 'start', 'move', 'end', 'click']);\n    this.handleDOMEvents();\n  }\n\n  ActionsHandler.prototype.handleDOMEvents = function () {\n    var _a = this.options,\n        bindToWrapper = _a.bindToWrapper,\n        disableMouse = _a.disableMouse,\n        disableTouch = _a.disableTouch,\n        click = _a.click;\n    var wrapper = this.wrapper;\n    var target = bindToWrapper ? wrapper : window;\n    var wrapperEvents = [];\n    var targetEvents = [];\n    var shouldRegisterTouch = !disableTouch;\n    var shouldRegisterMouse = !disableMouse;\n\n    if (click) {\n      wrapperEvents.push({\n        name: 'click',\n        handler: this.click.bind(this),\n        capture: true\n      });\n    }\n\n    if (shouldRegisterTouch) {\n      wrapperEvents.push({\n        name: 'touchstart',\n        handler: this.start.bind(this)\n      });\n      targetEvents.push({\n        name: 'touchmove',\n        handler: this.move.bind(this)\n      }, {\n        name: 'touchend',\n        handler: this.end.bind(this)\n      }, {\n        name: 'touchcancel',\n        handler: this.end.bind(this)\n      });\n    }\n\n    if (shouldRegisterMouse) {\n      wrapperEvents.push({\n        name: 'mousedown',\n        handler: this.start.bind(this)\n      });\n      targetEvents.push({\n        name: 'mousemove',\n        handler: this.move.bind(this)\n      }, {\n        name: 'mouseup',\n        handler: this.end.bind(this)\n      });\n    }\n\n    this.wrapperEventRegister = new EventRegister(wrapper, wrapperEvents);\n    this.targetEventRegister = new EventRegister(target, targetEvents);\n  };\n\n  ActionsHandler.prototype.beforeHandler = function (e, type) {\n    var _a = this.options,\n        preventDefault = _a.preventDefault,\n        stopPropagation = _a.stopPropagation,\n        preventDefaultException = _a.preventDefaultException;\n    var preventDefaultConditions = {\n      start: function () {\n        return preventDefault && !preventDefaultExceptionFn(e.target, preventDefaultException);\n      },\n      end: function () {\n        return preventDefault && !preventDefaultExceptionFn(e.target, preventDefaultException);\n      },\n      move: function () {\n        return preventDefault;\n      }\n    };\n\n    if (preventDefaultConditions[type]()) {\n      e.preventDefault();\n    }\n\n    if (stopPropagation) {\n      e.stopPropagation();\n    }\n  };\n\n  ActionsHandler.prototype.setInitiated = function (type) {\n    if (type === void 0) {\n      type = 0;\n    }\n\n    this.initiated = type;\n  };\n\n  ActionsHandler.prototype.start = function (e) {\n    var _eventType = eventTypeMap[e.type];\n\n    if (this.initiated && this.initiated !== _eventType) {\n      return;\n    }\n\n    this.setInitiated(_eventType); // if textarea or other html tags in options.tagException is manipulated\n    // do not make bs scroll\n\n    if (tagExceptionFn(e.target, this.options.tagException)) {\n      this.setInitiated();\n      return;\n    } // only allow mouse left button\n\n\n    if (_eventType === 2\n    /* Mouse */\n    && e.button !== 0\n    /* Left */\n    ) return;\n\n    if (this.hooks.trigger(this.hooks.eventTypes.beforeStart, e)) {\n      return;\n    }\n\n    this.beforeHandler(e, 'start');\n    var point = e.touches ? e.touches[0] : e;\n    this.pointX = point.pageX;\n    this.pointY = point.pageY;\n    this.hooks.trigger(this.hooks.eventTypes.start, e);\n  };\n\n  ActionsHandler.prototype.move = function (e) {\n    if (eventTypeMap[e.type] !== this.initiated) {\n      return;\n    }\n\n    this.beforeHandler(e, 'move');\n    var point = e.touches ? e.touches[0] : e;\n    var deltaX = point.pageX - this.pointX;\n    var deltaY = point.pageY - this.pointY;\n    this.pointX = point.pageX;\n    this.pointY = point.pageY;\n\n    if (this.hooks.trigger(this.hooks.eventTypes.move, {\n      deltaX: deltaX,\n      deltaY: deltaY,\n      e: e\n    })) {\n      return;\n    } // auto end when out of viewport\n\n\n    var scrollLeft = document.documentElement.scrollLeft || window.pageXOffset || document.body.scrollLeft;\n    var scrollTop = document.documentElement.scrollTop || window.pageYOffset || document.body.scrollTop;\n    var pX = this.pointX - scrollLeft;\n    var pY = this.pointY - scrollTop;\n    var autoEndDistance = this.options.autoEndDistance;\n\n    if (pX > document.documentElement.clientWidth - autoEndDistance || pY > document.documentElement.clientHeight - autoEndDistance || pX < autoEndDistance || pY < autoEndDistance) {\n      this.end(e);\n    }\n  };\n\n  ActionsHandler.prototype.end = function (e) {\n    if (eventTypeMap[e.type] !== this.initiated) {\n      return;\n    }\n\n    this.setInitiated();\n    this.beforeHandler(e, 'end');\n    this.hooks.trigger(this.hooks.eventTypes.end, e);\n  };\n\n  ActionsHandler.prototype.click = function (e) {\n    this.hooks.trigger(this.hooks.eventTypes.click, e);\n  };\n\n  ActionsHandler.prototype.setContent = function (content) {\n    if (content !== this.wrapper) {\n      this.wrapper = content;\n      this.rebindDOMEvents();\n    }\n  };\n\n  ActionsHandler.prototype.rebindDOMEvents = function () {\n    this.wrapperEventRegister.destroy();\n    this.targetEventRegister.destroy();\n    this.handleDOMEvents();\n  };\n\n  ActionsHandler.prototype.destroy = function () {\n    this.wrapperEventRegister.destroy();\n    this.targetEventRegister.destroy();\n    this.hooks.destroy();\n  };\n\n  return ActionsHandler;\n}();\n\nvar translaterMetaData = {\n  x: ['translateX', 'px'],\n  y: ['translateY', 'px']\n};\n\nvar Translater =\n/** @class */\nfunction () {\n  function Translater(content) {\n    this.setContent(content);\n    this.hooks = new EventEmitter(['beforeTranslate', 'translate']);\n  }\n\n  Translater.prototype.getComputedPosition = function () {\n    var cssStyle = window.getComputedStyle(this.content, null);\n    var matrix = cssStyle[style.transform].split(')')[0].split(', ');\n    var x = +(matrix[12] || matrix[4]) || 0;\n    var y = +(matrix[13] || matrix[5]) || 0;\n    return {\n      x: x,\n      y: y\n    };\n  };\n\n  Translater.prototype.translate = function (point) {\n    var transformStyle = [];\n    Object.keys(point).forEach(function (key) {\n      if (!translaterMetaData[key]) {\n        return;\n      }\n\n      var transformFnName = translaterMetaData[key][0];\n\n      if (transformFnName) {\n        var transformFnArgUnit = translaterMetaData[key][1];\n        var transformFnArg = point[key];\n        transformStyle.push(transformFnName + \"(\" + transformFnArg + transformFnArgUnit + \")\");\n      }\n    });\n    this.hooks.trigger(this.hooks.eventTypes.beforeTranslate, transformStyle, point);\n    this.style[style.transform] = transformStyle.join(' ');\n    this.hooks.trigger(this.hooks.eventTypes.translate, point);\n  };\n\n  Translater.prototype.setContent = function (content) {\n    if (this.content !== content) {\n      this.content = content;\n      this.style = content.style;\n    }\n  };\n\n  Translater.prototype.destroy = function () {\n    this.hooks.destroy();\n  };\n\n  return Translater;\n}();\n\nvar Base =\n/** @class */\nfunction () {\n  function Base(content, translater, options) {\n    this.translater = translater;\n    this.options = options;\n    this.timer = 0;\n    this.hooks = new EventEmitter(['move', 'end', 'beforeForceStop', 'forceStop', 'callStop', 'time', 'timeFunction']);\n    this.setContent(content);\n  }\n\n  Base.prototype.translate = function (endPoint) {\n    this.translater.translate(endPoint);\n  };\n\n  Base.prototype.setPending = function (pending) {\n    this.pending = pending;\n  };\n\n  Base.prototype.setForceStopped = function (forceStopped) {\n    this.forceStopped = forceStopped;\n  };\n\n  Base.prototype.setCallStop = function (called) {\n    this.callStopWhenPending = called;\n  };\n\n  Base.prototype.setContent = function (content) {\n    if (this.content !== content) {\n      this.content = content;\n      this.style = content.style;\n      this.stop();\n    }\n  };\n\n  Base.prototype.clearTimer = function () {\n    if (this.timer) {\n      cancelAnimationFrame(this.timer);\n      this.timer = 0;\n    }\n  };\n\n  Base.prototype.destroy = function () {\n    this.hooks.destroy();\n    cancelAnimationFrame(this.timer);\n  };\n\n  return Base;\n}(); // iOS 13.6 - 14.x, window.getComputedStyle sometimes will get wrong transform value\n// when bs use transition mode\n// eg: translateY -100px -> -200px, when the last frame which is about to scroll to -200px\n// window.getComputedStyle(this.content) will calculate transformY to be -100px(startPoint)\n// it is weird\n// so we should validate position caculated by 'window.getComputedStyle'\n\n\nvar isValidPostion = function (startPoint, endPoint, currentPos, prePos) {\n  var computeDirection = function (endValue, startValue) {\n    var delta = endValue - startValue;\n    var direction = delta > 0 ? -1\n    /* Negative */\n    : delta < 0 ? 1\n    /* Positive */\n    : 0\n    /* Default */\n    ;\n    return direction;\n  };\n\n  var directionX = computeDirection(endPoint.x, startPoint.x);\n  var directionY = computeDirection(endPoint.y, startPoint.y);\n  var deltaX = currentPos.x - prePos.x;\n  var deltaY = currentPos.y - prePos.y;\n  return directionX * deltaX <= 0 && directionY * deltaY <= 0;\n};\n\nvar Transition =\n/** @class */\nfunction (_super) {\n  __extends(Transition, _super);\n\n  function Transition() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  Transition.prototype.startProbe = function (startPoint, endPoint) {\n    var _this = this;\n\n    var prePos = startPoint;\n\n    var probe = function () {\n      var pos = _this.translater.getComputedPosition();\n\n      if (isValidPostion(startPoint, endPoint, pos, prePos)) {\n        _this.hooks.trigger(_this.hooks.eventTypes.move, pos);\n      } // call bs.stop() should not dispatch end hook again.\n      // forceStop hook will do this.\n\n      /* istanbul ignore if  */\n\n\n      if (!_this.pending) {\n        if (_this.callStopWhenPending) {\n          _this.callStopWhenPending = false;\n        } else {\n          // transition ends should dispatch end hook.\n          _this.hooks.trigger(_this.hooks.eventTypes.end, pos);\n        }\n      }\n\n      prePos = pos;\n\n      if (_this.pending) {\n        _this.timer = requestAnimationFrame(probe);\n      }\n    }; // when manually call bs.stop(), then bs.scrollTo()\n    // we should reset callStopWhenPending to dispatch end hook\n\n\n    if (this.callStopWhenPending) {\n      this.setCallStop(false);\n    }\n\n    cancelAnimationFrame(this.timer);\n    probe();\n  };\n\n  Transition.prototype.transitionTime = function (time) {\n    if (time === void 0) {\n      time = 0;\n    }\n\n    this.style[style.transitionDuration] = time + 'ms';\n    this.hooks.trigger(this.hooks.eventTypes.time, time);\n  };\n\n  Transition.prototype.transitionTimingFunction = function (easing) {\n    this.style[style.transitionTimingFunction] = easing;\n    this.hooks.trigger(this.hooks.eventTypes.timeFunction, easing);\n  };\n\n  Transition.prototype.transitionProperty = function () {\n    this.style[style.transitionProperty] = style.transform;\n  };\n\n  Transition.prototype.move = function (startPoint, endPoint, time, easingFn) {\n    this.setPending(time > 0);\n    this.transitionTimingFunction(easingFn);\n    this.transitionProperty();\n    this.transitionTime(time);\n    this.translate(endPoint);\n    var isRealtimeProbeType = this.options.probeType === 3\n    /* Realtime */\n    ;\n\n    if (time && isRealtimeProbeType) {\n      this.startProbe(startPoint, endPoint);\n    } // if we change content's transformY in a tick\n    // such as: 0 -> 50px -> 0\n    // transitionend will not be triggered\n    // so we forceupdate by reflow\n\n\n    if (!time) {\n      this._reflow = this.content.offsetHeight;\n\n      if (isRealtimeProbeType) {\n        this.hooks.trigger(this.hooks.eventTypes.move, endPoint);\n      }\n\n      this.hooks.trigger(this.hooks.eventTypes.end, endPoint);\n    }\n  };\n\n  Transition.prototype.doStop = function () {\n    var pending = this.pending;\n    this.setForceStopped(false);\n    this.setCallStop(false); // still in transition\n\n    if (pending) {\n      this.setPending(false);\n      cancelAnimationFrame(this.timer);\n\n      var _a = this.translater.getComputedPosition(),\n          x = _a.x,\n          y = _a.y;\n\n      this.transitionTime();\n      this.translate({\n        x: x,\n        y: y\n      });\n      this.setForceStopped(true);\n      this.setCallStop(true);\n      this.hooks.trigger(this.hooks.eventTypes.forceStop, {\n        x: x,\n        y: y\n      });\n    }\n\n    return pending;\n  };\n\n  Transition.prototype.stop = function () {\n    var stopFromTransition = this.doStop();\n\n    if (stopFromTransition) {\n      this.hooks.trigger(this.hooks.eventTypes.callStop);\n    }\n  };\n\n  return Transition;\n}(Base);\n\nvar Animation =\n/** @class */\nfunction (_super) {\n  __extends(Animation, _super);\n\n  function Animation() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  Animation.prototype.move = function (startPoint, endPoint, time, easingFn) {\n    // time is 0\n    if (!time) {\n      this.translate(endPoint);\n\n      if (this.options.probeType === 3\n      /* Realtime */\n      ) {\n        this.hooks.trigger(this.hooks.eventTypes.move, endPoint);\n      }\n\n      this.hooks.trigger(this.hooks.eventTypes.end, endPoint);\n      return;\n    }\n\n    this.animate(startPoint, endPoint, time, easingFn);\n  };\n\n  Animation.prototype.animate = function (startPoint, endPoint, duration, easingFn) {\n    var _this = this;\n\n    var startTime = getNow();\n    var destTime = startTime + duration;\n    var isRealtimeProbeType = this.options.probeType === 3\n    /* Realtime */\n    ;\n\n    var step = function () {\n      var now = getNow(); // js animation end\n\n      if (now >= destTime) {\n        _this.translate(endPoint);\n\n        if (isRealtimeProbeType) {\n          _this.hooks.trigger(_this.hooks.eventTypes.move, endPoint);\n        }\n\n        _this.hooks.trigger(_this.hooks.eventTypes.end, endPoint);\n\n        return;\n      }\n\n      now = (now - startTime) / duration;\n      var easing = easingFn(now);\n      var newPoint = {};\n      Object.keys(endPoint).forEach(function (key) {\n        var startValue = startPoint[key];\n        var endValue = endPoint[key];\n        newPoint[key] = (endValue - startValue) * easing + startValue;\n      });\n\n      _this.translate(newPoint);\n\n      if (isRealtimeProbeType) {\n        _this.hooks.trigger(_this.hooks.eventTypes.move, newPoint);\n      }\n\n      if (_this.pending) {\n        _this.timer = requestAnimationFrame(step);\n      } // call bs.stop() should not dispatch end hook again.\n      // forceStop hook will do this.\n\n      /* istanbul ignore if  */\n\n\n      if (!_this.pending) {\n        if (_this.callStopWhenPending) {\n          _this.callStopWhenPending = false;\n        } else {\n          // raf ends should dispatch end hook.\n          _this.hooks.trigger(_this.hooks.eventTypes.end, endPoint);\n        }\n      }\n    };\n\n    this.setPending(true); // when manually call bs.stop(), then bs.scrollTo()\n    // we should reset callStopWhenPending to dispatch end hook\n\n    if (this.callStopWhenPending) {\n      this.setCallStop(false);\n    }\n\n    cancelAnimationFrame(this.timer);\n    step();\n  };\n\n  Animation.prototype.doStop = function () {\n    var pending = this.pending;\n    this.setForceStopped(false);\n    this.setCallStop(false); // still in requestFrameAnimation\n\n    if (pending) {\n      this.setPending(false);\n      cancelAnimationFrame(this.timer);\n      var pos = this.translater.getComputedPosition();\n      this.setForceStopped(true);\n      this.setCallStop(true);\n      this.hooks.trigger(this.hooks.eventTypes.forceStop, pos);\n    }\n\n    return pending;\n  };\n\n  Animation.prototype.stop = function () {\n    var stopFromAnimation = this.doStop();\n\n    if (stopFromAnimation) {\n      this.hooks.trigger(this.hooks.eventTypes.callStop);\n    }\n  };\n\n  return Animation;\n}(Base);\n\nfunction createAnimater(element, translater, options) {\n  var useTransition = options.useTransition;\n  var animaterOptions = {};\n  Object.defineProperty(animaterOptions, 'probeType', {\n    enumerable: true,\n    configurable: false,\n    get: function () {\n      return options.probeType;\n    }\n  });\n\n  if (useTransition) {\n    return new Transition(element, translater, animaterOptions);\n  } else {\n    return new Animation(element, translater, animaterOptions);\n  }\n}\n\nvar Behavior =\n/** @class */\nfunction () {\n  function Behavior(wrapper, content, options) {\n    this.wrapper = wrapper;\n    this.options = options;\n    this.hooks = new EventEmitter(['beforeComputeBoundary', 'computeBoundary', 'momentum', 'end', 'ignoreHasScroll']);\n    this.refresh(content);\n  }\n\n  Behavior.prototype.start = function () {\n    this.dist = 0;\n    this.setMovingDirection(0\n    /* Default */\n    );\n    this.setDirection(0\n    /* Default */\n    );\n  };\n\n  Behavior.prototype.move = function (delta) {\n    delta = this.hasScroll ? delta : 0;\n    this.setMovingDirection(delta);\n    return this.performDampingAlgorithm(delta, this.options.outOfBoundaryDampingFactor);\n  };\n\n  Behavior.prototype.setMovingDirection = function (delta) {\n    this.movingDirection = delta > 0 ? -1\n    /* Negative */\n    : delta < 0 ? 1\n    /* Positive */\n    : 0\n    /* Default */\n    ;\n  };\n\n  Behavior.prototype.setDirection = function (delta) {\n    this.direction = delta > 0 ? -1\n    /* Negative */\n    : delta < 0 ? 1\n    /* Positive */\n    : 0\n    /* Default */\n    ;\n  };\n\n  Behavior.prototype.performDampingAlgorithm = function (delta, dampingFactor) {\n    var newPos = this.currentPos + delta; // Slow down or stop if outside of the boundaries\n\n    if (newPos > this.minScrollPos || newPos < this.maxScrollPos) {\n      if (newPos > this.minScrollPos && this.options.bounces[0] || newPos < this.maxScrollPos && this.options.bounces[1]) {\n        newPos = this.currentPos + delta * dampingFactor;\n      } else {\n        newPos = newPos > this.minScrollPos ? this.minScrollPos : this.maxScrollPos;\n      }\n    }\n\n    return newPos;\n  };\n\n  Behavior.prototype.end = function (duration) {\n    var momentumInfo = {\n      duration: 0\n    };\n    var absDist = Math.abs(this.currentPos - this.startPos); // start momentum animation if needed\n\n    if (this.options.momentum && duration < this.options.momentumLimitTime && absDist > this.options.momentumLimitDistance) {\n      var wrapperSize = this.direction === -1\n      /* Negative */\n      && this.options.bounces[0] || this.direction === 1\n      /* Positive */\n      && this.options.bounces[1] ? this.wrapperSize : 0;\n      momentumInfo = this.hasScroll ? this.momentum(this.currentPos, this.startPos, duration, this.maxScrollPos, this.minScrollPos, wrapperSize, this.options) : {\n        destination: this.currentPos,\n        duration: 0\n      };\n    } else {\n      this.hooks.trigger(this.hooks.eventTypes.end, momentumInfo);\n    }\n\n    return momentumInfo;\n  };\n\n  Behavior.prototype.momentum = function (current, start, time, lowerMargin, upperMargin, wrapperSize, options) {\n    if (options === void 0) {\n      options = this.options;\n    }\n\n    var distance = current - start;\n    var speed = Math.abs(distance) / time;\n    var deceleration = options.deceleration,\n        swipeBounceTime = options.swipeBounceTime,\n        swipeTime = options.swipeTime;\n    var duration = Math.min(swipeTime, speed * 2 / deceleration);\n    var momentumData = {\n      destination: current + speed * speed / deceleration * (distance < 0 ? -1 : 1),\n      duration: duration,\n      rate: 15\n    };\n    this.hooks.trigger(this.hooks.eventTypes.momentum, momentumData, distance);\n\n    if (momentumData.destination < lowerMargin) {\n      momentumData.destination = wrapperSize ? Math.max(lowerMargin - wrapperSize / 4, lowerMargin - wrapperSize / momentumData.rate * speed) : lowerMargin;\n      momentumData.duration = swipeBounceTime;\n    } else if (momentumData.destination > upperMargin) {\n      momentumData.destination = wrapperSize ? Math.min(upperMargin + wrapperSize / 4, upperMargin + wrapperSize / momentumData.rate * speed) : upperMargin;\n      momentumData.duration = swipeBounceTime;\n    }\n\n    momentumData.destination = Math.round(momentumData.destination);\n    return momentumData;\n  };\n\n  Behavior.prototype.updateDirection = function () {\n    var absDist = this.currentPos - this.absStartPos;\n    this.setDirection(absDist);\n  };\n\n  Behavior.prototype.refresh = function (content) {\n    var _a = this.options.rect,\n        size = _a.size,\n        position = _a.position;\n    var isWrapperStatic = window.getComputedStyle(this.wrapper, null).position === 'static'; // Force reflow\n\n    var wrapperRect = getRect(this.wrapper); // use client is more fair than offset\n\n    this.wrapperSize = this.wrapper[size === 'width' ? 'clientWidth' : 'clientHeight'];\n    this.setContent(content);\n    var contentRect = getRect(this.content);\n    this.contentSize = contentRect[size];\n    this.relativeOffset = contentRect[position];\n    /* istanbul ignore if  */\n\n    if (isWrapperStatic) {\n      this.relativeOffset -= wrapperRect[position];\n    }\n\n    this.computeBoundary();\n    this.setDirection(0\n    /* Default */\n    );\n  };\n\n  Behavior.prototype.setContent = function (content) {\n    if (content !== this.content) {\n      this.content = content;\n      this.resetState();\n    }\n  };\n\n  Behavior.prototype.resetState = function () {\n    this.currentPos = 0;\n    this.startPos = 0;\n    this.dist = 0;\n    this.setDirection(0\n    /* Default */\n    );\n    this.setMovingDirection(0\n    /* Default */\n    );\n    this.resetStartPos();\n  };\n\n  Behavior.prototype.computeBoundary = function () {\n    this.hooks.trigger(this.hooks.eventTypes.beforeComputeBoundary);\n    var boundary = {\n      minScrollPos: 0,\n      maxScrollPos: this.wrapperSize - this.contentSize\n    };\n\n    if (boundary.maxScrollPos < 0) {\n      boundary.maxScrollPos -= this.relativeOffset;\n\n      if (this.options.specifiedIndexAsContent === 0) {\n        boundary.minScrollPos = -this.relativeOffset;\n      }\n    }\n\n    this.hooks.trigger(this.hooks.eventTypes.computeBoundary, boundary);\n    this.minScrollPos = boundary.minScrollPos;\n    this.maxScrollPos = boundary.maxScrollPos;\n    this.hasScroll = this.options.scrollable && this.maxScrollPos < this.minScrollPos;\n\n    if (!this.hasScroll && this.minScrollPos < this.maxScrollPos) {\n      this.maxScrollPos = this.minScrollPos;\n      this.contentSize = this.wrapperSize;\n    }\n  };\n\n  Behavior.prototype.updatePosition = function (pos) {\n    this.currentPos = pos;\n  };\n\n  Behavior.prototype.getCurrentPos = function () {\n    return this.currentPos;\n  };\n\n  Behavior.prototype.checkInBoundary = function () {\n    var position = this.adjustPosition(this.currentPos);\n    var inBoundary = position === this.getCurrentPos();\n    return {\n      position: position,\n      inBoundary: inBoundary\n    };\n  }; // adjust position when out of boundary\n\n\n  Behavior.prototype.adjustPosition = function (pos) {\n    if (!this.hasScroll && !this.hooks.trigger(this.hooks.eventTypes.ignoreHasScroll)) {\n      pos = this.minScrollPos;\n    } else if (pos > this.minScrollPos) {\n      pos = this.minScrollPos;\n    } else if (pos < this.maxScrollPos) {\n      pos = this.maxScrollPos;\n    }\n\n    return pos;\n  };\n\n  Behavior.prototype.updateStartPos = function () {\n    this.startPos = this.currentPos;\n  };\n\n  Behavior.prototype.updateAbsStartPos = function () {\n    this.absStartPos = this.currentPos;\n  };\n\n  Behavior.prototype.resetStartPos = function () {\n    this.updateStartPos();\n    this.updateAbsStartPos();\n  };\n\n  Behavior.prototype.getAbsDist = function (delta) {\n    this.dist += delta;\n    return Math.abs(this.dist);\n  };\n\n  Behavior.prototype.destroy = function () {\n    this.hooks.destroy();\n  };\n\n  return Behavior;\n}();\n\nvar _a, _b, _c, _d;\n\nvar PassthroughHandlers = (_a = {}, _a[\"yes\"\n/* Yes */\n] = function (e) {\n  return true;\n}, _a[\"no\"\n/* No */\n] = function (e) {\n  e.preventDefault();\n  return false;\n}, _a);\nvar DirectionMap = (_b = {}, _b[\"horizontal\"\n/* Horizontal */\n] = (_c = {}, _c[\"yes\"\n/* Yes */\n] = \"horizontal\"\n/* Horizontal */\n, _c[\"no\"\n/* No */\n] = \"vertical\"\n/* Vertical */\n, _c), _b[\"vertical\"\n/* Vertical */\n] = (_d = {}, _d[\"yes\"\n/* Yes */\n] = \"vertical\"\n/* Vertical */\n, _d[\"no\"\n/* No */\n] = \"horizontal\"\n/* Horizontal */\n, _d), _b);\n\nvar DirectionLockAction =\n/** @class */\nfunction () {\n  function DirectionLockAction(directionLockThreshold, freeScroll, eventPassthrough) {\n    this.directionLockThreshold = directionLockThreshold;\n    this.freeScroll = freeScroll;\n    this.eventPassthrough = eventPassthrough;\n    this.reset();\n  }\n\n  DirectionLockAction.prototype.reset = function () {\n    this.directionLocked = \"\"\n    /* Default */\n    ;\n  };\n\n  DirectionLockAction.prototype.checkMovingDirection = function (absDistX, absDistY, e) {\n    this.computeDirectionLock(absDistX, absDistY);\n    return this.handleEventPassthrough(e);\n  };\n\n  DirectionLockAction.prototype.adjustDelta = function (deltaX, deltaY) {\n    if (this.directionLocked === \"horizontal\"\n    /* Horizontal */\n    ) {\n      deltaY = 0;\n    } else if (this.directionLocked === \"vertical\"\n    /* Vertical */\n    ) {\n      deltaX = 0;\n    }\n\n    return {\n      deltaX: deltaX,\n      deltaY: deltaY\n    };\n  };\n\n  DirectionLockAction.prototype.computeDirectionLock = function (absDistX, absDistY) {\n    // If you are scrolling in one direction, lock it\n    if (this.directionLocked === \"\"\n    /* Default */\n    && !this.freeScroll) {\n      if (absDistX > absDistY + this.directionLockThreshold) {\n        this.directionLocked = \"horizontal\"\n        /* Horizontal */\n        ; // lock horizontally\n      } else if (absDistY >= absDistX + this.directionLockThreshold) {\n        this.directionLocked = \"vertical\"\n        /* Vertical */\n        ; // lock vertically\n      } else {\n        this.directionLocked = \"none\"\n        /* None */\n        ; // no lock\n      }\n    }\n  };\n\n  DirectionLockAction.prototype.handleEventPassthrough = function (e) {\n    var handleMap = DirectionMap[this.directionLocked];\n\n    if (handleMap) {\n      if (this.eventPassthrough === handleMap[\"yes\"\n      /* Yes */\n      ]) {\n        return PassthroughHandlers[\"yes\"\n        /* Yes */\n        ](e);\n      } else if (this.eventPassthrough === handleMap[\"no\"\n      /* No */\n      ]) {\n        return PassthroughHandlers[\"no\"\n        /* No */\n        ](e);\n      }\n    }\n\n    return false;\n  };\n\n  return DirectionLockAction;\n}();\n\nvar applyQuadrantTransformation = function (deltaX, deltaY, quadrant) {\n  if (quadrant === 2\n  /* Second */\n  ) {\n    return [deltaY, -deltaX];\n  } else if (quadrant === 3\n  /* Third */\n  ) {\n    return [-deltaX, -deltaY];\n  } else if (quadrant === 4\n  /* Forth */\n  ) {\n    return [-deltaY, deltaX];\n  } else {\n    return [deltaX, deltaY];\n  }\n};\n\nvar ScrollerActions =\n/** @class */\nfunction () {\n  function ScrollerActions(scrollBehaviorX, scrollBehaviorY, actionsHandler, animater, options) {\n    this.hooks = new EventEmitter(['start', 'beforeMove', 'scrollStart', 'scroll', 'beforeEnd', 'end', 'scrollEnd', 'contentNotMoved', 'detectMovingDirection', 'coordinateTransformation']);\n    this.scrollBehaviorX = scrollBehaviorX;\n    this.scrollBehaviorY = scrollBehaviorY;\n    this.actionsHandler = actionsHandler;\n    this.animater = animater;\n    this.options = options;\n    this.directionLockAction = new DirectionLockAction(options.directionLockThreshold, options.freeScroll, options.eventPassthrough);\n    this.enabled = true;\n    this.bindActionsHandler();\n  }\n\n  ScrollerActions.prototype.bindActionsHandler = function () {\n    var _this = this; // [mouse|touch]start event\n\n\n    this.actionsHandler.hooks.on(this.actionsHandler.hooks.eventTypes.start, function (e) {\n      if (!_this.enabled) return true;\n      return _this.handleStart(e);\n    }); // [mouse|touch]move event\n\n    this.actionsHandler.hooks.on(this.actionsHandler.hooks.eventTypes.move, function (_a) {\n      var deltaX = _a.deltaX,\n          deltaY = _a.deltaY,\n          e = _a.e;\n      if (!_this.enabled) return true;\n\n      var _b = applyQuadrantTransformation(deltaX, deltaY, _this.options.quadrant),\n          transformateDeltaX = _b[0],\n          transformateDeltaY = _b[1];\n\n      var transformateDeltaData = {\n        deltaX: transformateDeltaX,\n        deltaY: transformateDeltaY\n      };\n\n      _this.hooks.trigger(_this.hooks.eventTypes.coordinateTransformation, transformateDeltaData);\n\n      return _this.handleMove(transformateDeltaData.deltaX, transformateDeltaData.deltaY, e);\n    }); // [mouse|touch]end event\n\n    this.actionsHandler.hooks.on(this.actionsHandler.hooks.eventTypes.end, function (e) {\n      if (!_this.enabled) return true;\n      return _this.handleEnd(e);\n    }); // click\n\n    this.actionsHandler.hooks.on(this.actionsHandler.hooks.eventTypes.click, function (e) {\n      // handle native click event\n      if (_this.enabled && !e._constructed) {\n        _this.handleClick(e);\n      }\n    });\n  };\n\n  ScrollerActions.prototype.handleStart = function (e) {\n    var timestamp = getNow();\n    this.fingerMoved = false;\n    this.contentMoved = false;\n    this.startTime = timestamp;\n    this.directionLockAction.reset();\n    this.scrollBehaviorX.start();\n    this.scrollBehaviorY.start(); // force stopping last transition or animation\n\n    this.animater.doStop();\n    this.scrollBehaviorX.resetStartPos();\n    this.scrollBehaviorY.resetStartPos();\n    this.hooks.trigger(this.hooks.eventTypes.start, e);\n  };\n\n  ScrollerActions.prototype.handleMove = function (deltaX, deltaY, e) {\n    if (this.hooks.trigger(this.hooks.eventTypes.beforeMove, e)) {\n      return;\n    }\n\n    var absDistX = this.scrollBehaviorX.getAbsDist(deltaX);\n    var absDistY = this.scrollBehaviorY.getAbsDist(deltaY);\n    var timestamp = getNow(); // We need to move at least momentumLimitDistance pixels\n    // for the scrolling to initiate\n\n    if (this.checkMomentum(absDistX, absDistY, timestamp)) {\n      return true;\n    }\n\n    if (this.directionLockAction.checkMovingDirection(absDistX, absDistY, e)) {\n      this.actionsHandler.setInitiated();\n      return true;\n    }\n\n    var delta = this.directionLockAction.adjustDelta(deltaX, deltaY);\n    var prevX = this.scrollBehaviorX.getCurrentPos();\n    var newX = this.scrollBehaviorX.move(delta.deltaX);\n    var prevY = this.scrollBehaviorY.getCurrentPos();\n    var newY = this.scrollBehaviorY.move(delta.deltaY);\n\n    if (this.hooks.trigger(this.hooks.eventTypes.detectMovingDirection)) {\n      return;\n    }\n\n    if (!this.fingerMoved) {\n      this.fingerMoved = true;\n    }\n\n    var positionChanged = newX !== prevX || newY !== prevY;\n\n    if (!this.contentMoved && !positionChanged) {\n      this.hooks.trigger(this.hooks.eventTypes.contentNotMoved);\n    }\n\n    if (!this.contentMoved && positionChanged) {\n      this.contentMoved = true;\n      this.hooks.trigger(this.hooks.eventTypes.scrollStart);\n    }\n\n    if (this.contentMoved && positionChanged) {\n      this.animater.translate({\n        x: newX,\n        y: newY\n      });\n      this.dispatchScroll(timestamp);\n    }\n  };\n\n  ScrollerActions.prototype.dispatchScroll = function (timestamp) {\n    // dispatch scroll in interval time\n    if (timestamp - this.startTime > this.options.momentumLimitTime) {\n      // refresh time and starting position to initiate a momentum\n      this.startTime = timestamp;\n      this.scrollBehaviorX.updateStartPos();\n      this.scrollBehaviorY.updateStartPos();\n\n      if (this.options.probeType === 1\n      /* Throttle */\n      ) {\n        this.hooks.trigger(this.hooks.eventTypes.scroll, this.getCurrentPos());\n      }\n    } // dispatch scroll all the time\n\n\n    if (this.options.probeType > 1\n    /* Throttle */\n    ) {\n      this.hooks.trigger(this.hooks.eventTypes.scroll, this.getCurrentPos());\n    }\n  };\n\n  ScrollerActions.prototype.checkMomentum = function (absDistX, absDistY, timestamp) {\n    return timestamp - this.endTime > this.options.momentumLimitTime && absDistY < this.options.momentumLimitDistance && absDistX < this.options.momentumLimitDistance;\n  };\n\n  ScrollerActions.prototype.handleEnd = function (e) {\n    if (this.hooks.trigger(this.hooks.eventTypes.beforeEnd, e)) {\n      return;\n    }\n\n    var currentPos = this.getCurrentPos();\n    this.scrollBehaviorX.updateDirection();\n    this.scrollBehaviorY.updateDirection();\n\n    if (this.hooks.trigger(this.hooks.eventTypes.end, e, currentPos)) {\n      return true;\n    }\n\n    currentPos = this.ensureIntegerPos(currentPos);\n    this.animater.translate(currentPos);\n    this.endTime = getNow();\n    var duration = this.endTime - this.startTime;\n    this.hooks.trigger(this.hooks.eventTypes.scrollEnd, currentPos, duration);\n  };\n\n  ScrollerActions.prototype.ensureIntegerPos = function (currentPos) {\n    this.ensuringInteger = true;\n    var x = currentPos.x,\n        y = currentPos.y;\n    var _a = this.scrollBehaviorX,\n        minScrollPosX = _a.minScrollPos,\n        maxScrollPosX = _a.maxScrollPos;\n    var _b = this.scrollBehaviorY,\n        minScrollPosY = _b.minScrollPos,\n        maxScrollPosY = _b.maxScrollPos;\n    x = x > 0 ? Math.ceil(x) : Math.floor(x);\n    y = y > 0 ? Math.ceil(y) : Math.floor(y);\n    x = between(x, maxScrollPosX, minScrollPosX);\n    y = between(y, maxScrollPosY, minScrollPosY);\n    return {\n      x: x,\n      y: y\n    };\n  };\n\n  ScrollerActions.prototype.handleClick = function (e) {\n    if (!preventDefaultExceptionFn(e.target, this.options.preventDefaultException)) {\n      e.preventDefault();\n      e.stopPropagation();\n    }\n  };\n\n  ScrollerActions.prototype.getCurrentPos = function () {\n    return {\n      x: this.scrollBehaviorX.getCurrentPos(),\n      y: this.scrollBehaviorY.getCurrentPos()\n    };\n  };\n\n  ScrollerActions.prototype.refresh = function () {\n    this.endTime = 0;\n  };\n\n  ScrollerActions.prototype.destroy = function () {\n    this.hooks.destroy();\n  };\n\n  return ScrollerActions;\n}();\n\nfunction createActionsHandlerOptions(bsOptions) {\n  var options = ['click', 'bindToWrapper', 'disableMouse', 'disableTouch', 'preventDefault', 'stopPropagation', 'tagException', 'preventDefaultException', 'autoEndDistance'].reduce(function (prev, cur) {\n    prev[cur] = bsOptions[cur];\n    return prev;\n  }, {});\n  return options;\n}\n\nfunction createBehaviorOptions(bsOptions, extraProp, bounces, rect) {\n  var options = ['momentum', 'momentumLimitTime', 'momentumLimitDistance', 'deceleration', 'swipeBounceTime', 'swipeTime', 'outOfBoundaryDampingFactor', 'specifiedIndexAsContent'].reduce(function (prev, cur) {\n    prev[cur] = bsOptions[cur];\n    return prev;\n  }, {}); // add extra property\n\n  options.scrollable = !!bsOptions[extraProp];\n  options.bounces = bounces;\n  options.rect = rect;\n  return options;\n}\n\nfunction bubbling(source, target, events) {\n  events.forEach(function (event) {\n    var sourceEvent;\n    var targetEvent;\n\n    if (typeof event === 'string') {\n      sourceEvent = targetEvent = event;\n    } else {\n      sourceEvent = event.source;\n      targetEvent = event.target;\n    }\n\n    source.on(sourceEvent, function () {\n      var args = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n\n      return target.trigger.apply(target, __spreadArrays([targetEvent], args));\n    });\n  });\n}\n\nfunction isSamePoint(startPoint, endPoint) {\n  // keys of startPoint and endPoint should be equal\n  var keys = Object.keys(startPoint);\n\n  for (var _i = 0, keys_1 = keys; _i < keys_1.length; _i++) {\n    var key = keys_1[_i];\n    if (startPoint[key] !== endPoint[key]) return false;\n  }\n\n  return true;\n}\n\nvar MIN_SCROLL_DISTANCE = 1;\n\nvar Scroller =\n/** @class */\nfunction () {\n  function Scroller(wrapper, content, options) {\n    this.wrapper = wrapper;\n    this.content = content;\n    this.resizeTimeout = 0;\n    this.hooks = new EventEmitter(['beforeStart', 'beforeMove', 'beforeScrollStart', 'scrollStart', 'scroll', 'beforeEnd', 'scrollEnd', 'resize', 'touchEnd', 'end', 'flick', 'scrollCancel', 'momentum', 'scrollTo', 'minDistanceScroll', 'scrollToElement', 'beforeRefresh']);\n    this.options = options;\n    var _a = this.options.bounce,\n        left = _a.left,\n        right = _a.right,\n        top = _a.top,\n        bottom = _a.bottom; // direction X\n\n    this.scrollBehaviorX = new Behavior(wrapper, content, createBehaviorOptions(options, 'scrollX', [left, right], {\n      size: 'width',\n      position: 'left'\n    })); // direction Y\n\n    this.scrollBehaviorY = new Behavior(wrapper, content, createBehaviorOptions(options, 'scrollY', [top, bottom], {\n      size: 'height',\n      position: 'top'\n    }));\n    this.translater = new Translater(this.content);\n    this.animater = createAnimater(this.content, this.translater, this.options);\n    this.actionsHandler = new ActionsHandler(this.options.bindToTarget ? this.content : wrapper, createActionsHandlerOptions(this.options));\n    this.actions = new ScrollerActions(this.scrollBehaviorX, this.scrollBehaviorY, this.actionsHandler, this.animater, this.options);\n    var resizeHandler = this.resize.bind(this);\n    this.resizeRegister = new EventRegister(window, [{\n      name: 'orientationchange',\n      handler: resizeHandler\n    }, {\n      name: 'resize',\n      handler: resizeHandler\n    }]);\n    this.registerTransitionEnd();\n    this.init();\n  }\n\n  Scroller.prototype.init = function () {\n    var _this = this;\n\n    this.bindTranslater();\n    this.bindAnimater();\n    this.bindActions(); // enable pointer events when scrolling ends\n\n    this.hooks.on(this.hooks.eventTypes.scrollEnd, function () {\n      _this.togglePointerEvents(true);\n    });\n  };\n\n  Scroller.prototype.registerTransitionEnd = function () {\n    this.transitionEndRegister = new EventRegister(this.content, [{\n      name: style.transitionEnd,\n      handler: this.transitionEnd.bind(this)\n    }]);\n  };\n\n  Scroller.prototype.bindTranslater = function () {\n    var _this = this;\n\n    var hooks = this.translater.hooks;\n    hooks.on(hooks.eventTypes.beforeTranslate, function (transformStyle) {\n      if (_this.options.translateZ) {\n        transformStyle.push(_this.options.translateZ);\n      }\n    }); // disable pointer events when scrolling\n\n    hooks.on(hooks.eventTypes.translate, function (pos) {\n      var prevPos = _this.getCurrentPos();\n\n      _this.updatePositions(pos); // scrollEnd will dispatch when scroll is force stopping in touchstart handler\n      // so in touchend handler, don't toggle pointer-events\n\n\n      if (_this.actions.ensuringInteger === true) {\n        _this.actions.ensuringInteger = false;\n        return;\n      } // a valid translate\n\n\n      if (pos.x !== prevPos.x || pos.y !== prevPos.y) {\n        _this.togglePointerEvents(false);\n      }\n    });\n  };\n\n  Scroller.prototype.bindAnimater = function () {\n    var _this = this; // reset position\n\n\n    this.animater.hooks.on(this.animater.hooks.eventTypes.end, function (pos) {\n      if (!_this.resetPosition(_this.options.bounceTime)) {\n        _this.animater.setPending(false);\n\n        _this.hooks.trigger(_this.hooks.eventTypes.scrollEnd, pos);\n      }\n    });\n    bubbling(this.animater.hooks, this.hooks, [{\n      source: this.animater.hooks.eventTypes.move,\n      target: this.hooks.eventTypes.scroll\n    }, {\n      source: this.animater.hooks.eventTypes.forceStop,\n      target: this.hooks.eventTypes.scrollEnd\n    }]);\n  };\n\n  Scroller.prototype.bindActions = function () {\n    var _this = this;\n\n    var actions = this.actions;\n    bubbling(actions.hooks, this.hooks, [{\n      source: actions.hooks.eventTypes.start,\n      target: this.hooks.eventTypes.beforeStart\n    }, {\n      source: actions.hooks.eventTypes.start,\n      target: this.hooks.eventTypes.beforeScrollStart\n    }, {\n      source: actions.hooks.eventTypes.beforeMove,\n      target: this.hooks.eventTypes.beforeMove\n    }, {\n      source: actions.hooks.eventTypes.scrollStart,\n      target: this.hooks.eventTypes.scrollStart\n    }, {\n      source: actions.hooks.eventTypes.scroll,\n      target: this.hooks.eventTypes.scroll\n    }, {\n      source: actions.hooks.eventTypes.beforeEnd,\n      target: this.hooks.eventTypes.beforeEnd\n    }]);\n    actions.hooks.on(actions.hooks.eventTypes.end, function (e, pos) {\n      _this.hooks.trigger(_this.hooks.eventTypes.touchEnd, pos);\n\n      if (_this.hooks.trigger(_this.hooks.eventTypes.end, pos)) {\n        return true;\n      } // check if it is a click operation\n\n\n      if (!actions.fingerMoved) {\n        _this.hooks.trigger(_this.hooks.eventTypes.scrollCancel);\n\n        if (_this.checkClick(e)) {\n          return true;\n        }\n      } // reset if we are outside of the boundaries\n\n\n      if (_this.resetPosition(_this.options.bounceTime, ease.bounce)) {\n        _this.animater.setForceStopped(false);\n\n        return true;\n      }\n    });\n    actions.hooks.on(actions.hooks.eventTypes.scrollEnd, function (pos, duration) {\n      var deltaX = Math.abs(pos.x - _this.scrollBehaviorX.startPos);\n      var deltaY = Math.abs(pos.y - _this.scrollBehaviorY.startPos);\n\n      if (_this.checkFlick(duration, deltaX, deltaY)) {\n        _this.animater.setForceStopped(false);\n\n        _this.hooks.trigger(_this.hooks.eventTypes.flick);\n\n        return;\n      }\n\n      if (_this.momentum(pos, duration)) {\n        _this.animater.setForceStopped(false);\n\n        return;\n      }\n\n      if (actions.contentMoved) {\n        _this.hooks.trigger(_this.hooks.eventTypes.scrollEnd, pos);\n      }\n\n      if (_this.animater.forceStopped) {\n        _this.animater.setForceStopped(false);\n      }\n    });\n  };\n\n  Scroller.prototype.checkFlick = function (duration, deltaX, deltaY) {\n    var flickMinMovingDistance = 1; // distinguish flick from click\n\n    if (this.hooks.events.flick.length > 1 && duration < this.options.flickLimitTime && deltaX < this.options.flickLimitDistance && deltaY < this.options.flickLimitDistance && (deltaY > flickMinMovingDistance || deltaX > flickMinMovingDistance)) {\n      return true;\n    }\n  };\n\n  Scroller.prototype.momentum = function (pos, duration) {\n    var meta = {\n      time: 0,\n      easing: ease.swiper,\n      newX: pos.x,\n      newY: pos.y\n    }; // start momentum animation if needed\n\n    var momentumX = this.scrollBehaviorX.end(duration);\n    var momentumY = this.scrollBehaviorY.end(duration);\n    meta.newX = isUndef(momentumX.destination) ? meta.newX : momentumX.destination;\n    meta.newY = isUndef(momentumY.destination) ? meta.newY : momentumY.destination;\n    meta.time = Math.max(momentumX.duration, momentumY.duration);\n    this.hooks.trigger(this.hooks.eventTypes.momentum, meta, this); // when x or y changed, do momentum animation now!\n\n    if (meta.newX !== pos.x || meta.newY !== pos.y) {\n      // change easing function when scroller goes out of the boundaries\n      if (meta.newX > this.scrollBehaviorX.minScrollPos || meta.newX < this.scrollBehaviorX.maxScrollPos || meta.newY > this.scrollBehaviorY.minScrollPos || meta.newY < this.scrollBehaviorY.maxScrollPos) {\n        meta.easing = ease.swipeBounce;\n      }\n\n      this.scrollTo(meta.newX, meta.newY, meta.time, meta.easing);\n      return true;\n    }\n  };\n\n  Scroller.prototype.checkClick = function (e) {\n    var cancelable = {\n      preventClick: this.animater.forceStopped\n    }; // we scrolled less than momentumLimitDistance pixels\n\n    if (this.hooks.trigger(this.hooks.eventTypes.checkClick)) {\n      this.animater.setForceStopped(false);\n      return true;\n    }\n\n    if (!cancelable.preventClick) {\n      var _dblclick = this.options.dblclick;\n      var dblclickTrigged = false;\n\n      if (_dblclick && this.lastClickTime) {\n        var _a = _dblclick.delay,\n            delay = _a === void 0 ? 300 : _a;\n\n        if (getNow() - this.lastClickTime < delay) {\n          dblclickTrigged = true;\n          dblclick(e);\n        }\n      }\n\n      if (this.options.tap) {\n        tap(e, this.options.tap);\n      }\n\n      if (this.options.click && !preventDefaultExceptionFn(e.target, this.options.preventDefaultException)) {\n        click(e);\n      }\n\n      this.lastClickTime = dblclickTrigged ? null : getNow();\n      return true;\n    }\n\n    return false;\n  };\n\n  Scroller.prototype.resize = function () {\n    var _this = this;\n\n    if (!this.actions.enabled) {\n      return;\n    } // fix a scroll problem under Android condition\n\n    /* istanbul ignore if  */\n\n\n    if (isAndroid) {\n      this.wrapper.scrollTop = 0;\n    }\n\n    clearTimeout(this.resizeTimeout);\n    this.resizeTimeout = window.setTimeout(function () {\n      _this.hooks.trigger(_this.hooks.eventTypes.resize);\n    }, this.options.resizePolling);\n  };\n  /* istanbul ignore next */\n\n\n  Scroller.prototype.transitionEnd = function (e) {\n    if (e.target !== this.content || !this.animater.pending) {\n      return;\n    }\n\n    var animater = this.animater;\n    animater.transitionTime();\n\n    if (!this.resetPosition(this.options.bounceTime, ease.bounce)) {\n      this.animater.setPending(false);\n\n      if (this.options.probeType !== 3\n      /* Realtime */\n      ) {\n        this.hooks.trigger(this.hooks.eventTypes.scrollEnd, this.getCurrentPos());\n      }\n    }\n  };\n\n  Scroller.prototype.togglePointerEvents = function (enabled) {\n    if (enabled === void 0) {\n      enabled = true;\n    }\n\n    var el = this.content.children.length ? this.content.children : [this.content];\n    var pointerEvents = enabled ? 'auto' : 'none';\n\n    for (var i = 0; i < el.length; i++) {\n      var node = el[i]; // ignore BetterScroll instance's wrapper DOM\n\n      /* istanbul ignore if  */\n\n      if (node.isBScrollContainer) {\n        continue;\n      }\n\n      node.style.pointerEvents = pointerEvents;\n    }\n  };\n\n  Scroller.prototype.refresh = function (content) {\n    var contentChanged = this.setContent(content);\n    this.hooks.trigger(this.hooks.eventTypes.beforeRefresh);\n    this.scrollBehaviorX.refresh(content);\n    this.scrollBehaviorY.refresh(content);\n\n    if (contentChanged) {\n      this.translater.setContent(content);\n      this.animater.setContent(content);\n      this.transitionEndRegister.destroy();\n      this.registerTransitionEnd();\n\n      if (this.options.bindToTarget) {\n        this.actionsHandler.setContent(content);\n      }\n    }\n\n    this.actions.refresh();\n    this.wrapperOffset = offset(this.wrapper);\n  };\n\n  Scroller.prototype.setContent = function (content) {\n    var contentChanged = content !== this.content;\n\n    if (contentChanged) {\n      this.content = content;\n    }\n\n    return contentChanged;\n  };\n\n  Scroller.prototype.scrollBy = function (deltaX, deltaY, time, easing) {\n    if (time === void 0) {\n      time = 0;\n    }\n\n    var _a = this.getCurrentPos(),\n        x = _a.x,\n        y = _a.y;\n\n    easing = !easing ? ease.bounce : easing;\n    deltaX += x;\n    deltaY += y;\n    this.scrollTo(deltaX, deltaY, time, easing);\n  };\n\n  Scroller.prototype.scrollTo = function (x, y, time, easing, extraTransform) {\n    if (time === void 0) {\n      time = 0;\n    }\n\n    if (easing === void 0) {\n      easing = ease.bounce;\n    }\n\n    if (extraTransform === void 0) {\n      extraTransform = {\n        start: {},\n        end: {}\n      };\n    }\n\n    var easingFn = this.options.useTransition ? easing.style : easing.fn;\n    var currentPos = this.getCurrentPos();\n\n    var startPoint = __assign({\n      x: currentPos.x,\n      y: currentPos.y\n    }, extraTransform.start);\n\n    var endPoint = __assign({\n      x: x,\n      y: y\n    }, extraTransform.end);\n\n    this.hooks.trigger(this.hooks.eventTypes.scrollTo, endPoint); // it is an useless move\n\n    if (isSamePoint(startPoint, endPoint)) return;\n    var deltaX = Math.abs(endPoint.x - startPoint.x);\n    var deltaY = Math.abs(endPoint.y - startPoint.y); // considering of browser compatibility for decimal transform value\n    // force translating immediately\n\n    if (deltaX < MIN_SCROLL_DISTANCE && deltaY < MIN_SCROLL_DISTANCE) {\n      time = 0;\n      this.hooks.trigger(this.hooks.eventTypes.minDistanceScroll);\n    }\n\n    this.animater.move(startPoint, endPoint, time, easingFn);\n  };\n\n  Scroller.prototype.scrollToElement = function (el, time, offsetX, offsetY, easing) {\n    var targetEle = getElement(el);\n    var pos = offset(targetEle);\n\n    var getOffset = function (offset, size, wrapperSize) {\n      if (typeof offset === 'number') {\n        return offset;\n      } // if offsetX/Y are true we center the element to the screen\n\n\n      return offset ? Math.round(size / 2 - wrapperSize / 2) : 0;\n    };\n\n    offsetX = getOffset(offsetX, targetEle.offsetWidth, this.wrapper.offsetWidth);\n    offsetY = getOffset(offsetY, targetEle.offsetHeight, this.wrapper.offsetHeight);\n\n    var getPos = function (pos, wrapperPos, offset, scrollBehavior) {\n      pos -= wrapperPos;\n      pos = scrollBehavior.adjustPosition(pos - offset);\n      return pos;\n    };\n\n    pos.left = getPos(pos.left, this.wrapperOffset.left, offsetX, this.scrollBehaviorX);\n    pos.top = getPos(pos.top, this.wrapperOffset.top, offsetY, this.scrollBehaviorY);\n\n    if (this.hooks.trigger(this.hooks.eventTypes.scrollToElement, targetEle, pos)) {\n      return;\n    }\n\n    this.scrollTo(pos.left, pos.top, time, easing);\n  };\n\n  Scroller.prototype.resetPosition = function (time, easing) {\n    if (time === void 0) {\n      time = 0;\n    }\n\n    if (easing === void 0) {\n      easing = ease.bounce;\n    }\n\n    var _a = this.scrollBehaviorX.checkInBoundary(),\n        x = _a.position,\n        xInBoundary = _a.inBoundary;\n\n    var _b = this.scrollBehaviorY.checkInBoundary(),\n        y = _b.position,\n        yInBoundary = _b.inBoundary;\n\n    if (xInBoundary && yInBoundary) {\n      return false;\n    }\n    /* istanbul ignore if  */\n\n\n    if (isIOSBadVersion) {\n      // fix ios 13.4 bouncing\n      // see it in issues 982\n      this.reflow();\n    } // out of boundary\n\n\n    this.scrollTo(x, y, time, easing);\n    return true;\n  };\n  /* istanbul ignore next */\n\n\n  Scroller.prototype.reflow = function () {\n    this._reflow = this.content.offsetHeight;\n  };\n\n  Scroller.prototype.updatePositions = function (pos) {\n    this.scrollBehaviorX.updatePosition(pos.x);\n    this.scrollBehaviorY.updatePosition(pos.y);\n  };\n\n  Scroller.prototype.getCurrentPos = function () {\n    return this.actions.getCurrentPos();\n  };\n\n  Scroller.prototype.enable = function () {\n    this.actions.enabled = true;\n  };\n\n  Scroller.prototype.disable = function () {\n    cancelAnimationFrame(this.animater.timer);\n    this.actions.enabled = false;\n  };\n\n  Scroller.prototype.destroy = function () {\n    var _this = this;\n\n    var keys = ['resizeRegister', 'transitionEndRegister', 'actionsHandler', 'actions', 'hooks', 'animater', 'translater', 'scrollBehaviorX', 'scrollBehaviorY'];\n    keys.forEach(function (key) {\n      return _this[key].destroy();\n    });\n  };\n\n  return Scroller;\n}();\n\nvar BScrollConstructor =\n/** @class */\nfunction (_super) {\n  __extends(BScrollConstructor, _super);\n\n  function BScrollConstructor(el, options) {\n    var _this = _super.call(this, ['refresh', 'contentChanged', 'enable', 'disable', 'beforeScrollStart', 'scrollStart', 'scroll', 'scrollEnd', 'scrollCancel', 'touchEnd', 'flick', 'destroy']) || this;\n\n    var wrapper = getElement(el);\n\n    if (!wrapper) {\n      warn('Can not resolve the wrapper DOM.');\n      return _this;\n    }\n\n    _this.plugins = {};\n    _this.options = new OptionsConstructor().merge(options).process();\n\n    if (!_this.setContent(wrapper).valid) {\n      return _this;\n    }\n\n    _this.hooks = new EventEmitter(['refresh', 'enable', 'disable', 'destroy', 'beforeInitialScrollTo', 'contentChanged']);\n\n    _this.init(wrapper);\n\n    return _this;\n  }\n\n  BScrollConstructor.use = function (ctor) {\n    var name = ctor.pluginName;\n    var installed = BScrollConstructor.plugins.some(function (plugin) {\n      return ctor === plugin.ctor;\n    });\n    if (installed) return BScrollConstructor;\n\n    if (isUndef(name)) {\n      warn(\"Plugin Class must specify plugin's name in static property by 'pluginName' field.\");\n      return BScrollConstructor;\n    }\n\n    BScrollConstructor.pluginsMap[name] = true;\n    BScrollConstructor.plugins.push({\n      name: name,\n      applyOrder: ctor.applyOrder,\n      ctor: ctor\n    });\n    return BScrollConstructor;\n  };\n\n  BScrollConstructor.prototype.setContent = function (wrapper) {\n    var contentChanged = false;\n    var valid = true;\n    var content = wrapper.children[this.options.specifiedIndexAsContent];\n\n    if (!content) {\n      warn('The wrapper need at least one child element to be content element to scroll.');\n      valid = false;\n    } else {\n      contentChanged = this.content !== content;\n\n      if (contentChanged) {\n        this.content = content;\n      }\n    }\n\n    return {\n      valid: valid,\n      contentChanged: contentChanged\n    };\n  };\n\n  BScrollConstructor.prototype.init = function (wrapper) {\n    var _this = this;\n\n    this.wrapper = wrapper; // mark wrapper to recognize bs instance by DOM attribute\n\n    wrapper.isBScrollContainer = true;\n    this.scroller = new Scroller(wrapper, this.content, this.options);\n    this.scroller.hooks.on(this.scroller.hooks.eventTypes.resize, function () {\n      _this.refresh();\n    });\n    this.eventBubbling();\n    this.handleAutoBlur();\n    this.enable();\n    this.proxy(propertiesConfig);\n    this.applyPlugins(); // maybe boundary has changed, should refresh\n\n    this.refreshWithoutReset(this.content);\n    var _a = this.options,\n        startX = _a.startX,\n        startY = _a.startY;\n    var position = {\n      x: startX,\n      y: startY\n    }; // maybe plugins want to control scroll position\n\n    if (this.hooks.trigger(this.hooks.eventTypes.beforeInitialScrollTo, position)) {\n      return;\n    }\n\n    this.scroller.scrollTo(position.x, position.y);\n  };\n\n  BScrollConstructor.prototype.applyPlugins = function () {\n    var _this = this;\n\n    var options = this.options;\n    BScrollConstructor.plugins.sort(function (a, b) {\n      var _a;\n\n      var applyOrderMap = (_a = {}, _a[\"pre\"\n      /* Pre */\n      ] = -1, _a[\"post\"\n      /* Post */\n      ] = 1, _a);\n      var aOrder = a.applyOrder ? applyOrderMap[a.applyOrder] : 0;\n      var bOrder = b.applyOrder ? applyOrderMap[b.applyOrder] : 0;\n      return aOrder - bOrder;\n    }).forEach(function (item) {\n      var ctor = item.ctor;\n\n      if (options[item.name] && typeof ctor === 'function') {\n        _this.plugins[item.name] = new ctor(_this);\n      }\n    });\n  };\n\n  BScrollConstructor.prototype.handleAutoBlur = function () {\n    /* istanbul ignore if  */\n    if (this.options.autoBlur) {\n      this.on(this.eventTypes.beforeScrollStart, function () {\n        var activeElement = document.activeElement;\n\n        if (activeElement && (activeElement.tagName === 'INPUT' || activeElement.tagName === 'TEXTAREA')) {\n          activeElement.blur();\n        }\n      });\n    }\n  };\n\n  BScrollConstructor.prototype.eventBubbling = function () {\n    bubbling(this.scroller.hooks, this, [this.eventTypes.beforeScrollStart, this.eventTypes.scrollStart, this.eventTypes.scroll, this.eventTypes.scrollEnd, this.eventTypes.scrollCancel, this.eventTypes.touchEnd, this.eventTypes.flick]);\n  };\n\n  BScrollConstructor.prototype.refreshWithoutReset = function (content) {\n    this.scroller.refresh(content);\n    this.hooks.trigger(this.hooks.eventTypes.refresh, content);\n    this.trigger(this.eventTypes.refresh, content);\n  };\n\n  BScrollConstructor.prototype.proxy = function (propertiesConfig) {\n    var _this = this;\n\n    propertiesConfig.forEach(function (_a) {\n      var key = _a.key,\n          sourceKey = _a.sourceKey;\n      propertiesProxy(_this, sourceKey, key);\n    });\n  };\n\n  BScrollConstructor.prototype.refresh = function () {\n    var _a = this.setContent(this.wrapper),\n        contentChanged = _a.contentChanged,\n        valid = _a.valid;\n\n    if (valid) {\n      var content = this.content;\n      this.refreshWithoutReset(content);\n\n      if (contentChanged) {\n        this.hooks.trigger(this.hooks.eventTypes.contentChanged, content);\n        this.trigger(this.eventTypes.contentChanged, content);\n      }\n\n      this.scroller.resetPosition();\n    }\n  };\n\n  BScrollConstructor.prototype.enable = function () {\n    this.scroller.enable();\n    this.hooks.trigger(this.hooks.eventTypes.enable);\n    this.trigger(this.eventTypes.enable);\n  };\n\n  BScrollConstructor.prototype.disable = function () {\n    this.scroller.disable();\n    this.hooks.trigger(this.hooks.eventTypes.disable);\n    this.trigger(this.eventTypes.disable);\n  };\n\n  BScrollConstructor.prototype.destroy = function () {\n    this.hooks.trigger(this.hooks.eventTypes.destroy);\n    this.trigger(this.eventTypes.destroy);\n    this.scroller.destroy();\n  };\n\n  BScrollConstructor.prototype.eventRegister = function (names) {\n    this.registerType(names);\n  };\n\n  BScrollConstructor.plugins = [];\n  BScrollConstructor.pluginsMap = {};\n  return BScrollConstructor;\n}(EventEmitter);\n\nfunction createBScroll(el, options) {\n  var bs = new BScrollConstructor(el, options);\n  return bs;\n}\n\ncreateBScroll.use = BScrollConstructor.use;\ncreateBScroll.plugins = BScrollConstructor.plugins;\ncreateBScroll.pluginsMap = BScrollConstructor.pluginsMap;\nvar BScroll = createBScroll;\nexport default BScroll;\nexport { Behavior, CustomOptions, createBScroll };","map":{"version":3,"names":["extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","prototype","hasOwnProperty","call","__extends","__","constructor","create","__assign","assign","t","s","i","n","arguments","length","apply","__spreadArrays","il","r","k","a","j","jl","propertiesConfig","sourceKey","key","warn","msg","console","error","inBrowser","window","ua","navigator","userAgent","toLowerCase","isWeChatDevTools","test","isAndroid","indexOf","isIOSBadVersion","regex","matches","exec","parts","split","map","item","parseInt","supportsPassive","EventName","opts","defineProperty","get","addEventListener","e","getNow","performance","now","timing","navigationStart","Date","extend","target","source","isUndef","v","undefined","between","x","min","max","elementStyle","document","createElement","style","vendor","transformNames","value","_i","transformNames_1","obj","prefixStyle","charAt","toUpperCase","substr","getElement","el","querySelector","addEvent","type","fn","capture","useCapture","passive","removeEvent","removeEventListener","offset","left","top","offsetLeft","offsetTop","offsetParent","transform","transition","hasPerspective","hasTouch","hasTransition","transitionTimingFunction","transitionDuration","transitionDelay","transformOrigin","transitionEnd","transitionProperty","eventTypeMap","touchstart","touchmove","touchend","touchcancel","mousedown","mousemove","mouseup","getRect","SVGElement","rect","getBoundingClientRect","width","height","offsetWidth","offsetHeight","preventDefaultExceptionFn","exceptions","tagExceptionFn","tap","eventName","ev","createEvent","initEvent","pageX","pageY","dispatchEvent","click","event","eventSource","changedTouches","posSrc","screenX","screenY","clientX","clientY","bubbles","cancelable","ctrlKey","shiftKey","altKey","metaKey","pressedKeysMap","MouseEvent","forwardedTouchEvent","_constructed","dblclick","ease","swipe","swipeBounce","bounce","DEFAULT_INTERVAL","windowCompat","noop$1","requestAnimationFrame","webkitRequestAnimationFrame","mozRequestAnimationFrame","oRequestAnimationFrame","callback","setTimeout","interval","cancelAnimationFrame","webkitCancelAnimationFrame","mozCancelAnimationFrame","oCancelAnimationFrame","id","clearTimeout","noop","val","sharedPropertyDefinition","enumerable","configurable","set","getProperty","keys","lastKey","pop","setProperty","temp","propertiesProxy","proxyGetter","proxySetter","EventEmitter","names","events","eventTypes","registerType","on","context","hasType","push","once","_this","magic","args","off","ret","count","splice","trigger","len","eventsCopy","event_1","forEach","destroy","types","isType","_","JSON","stringify","EventRegister","wrapper","addDOMEvents","removeDOMEvents","handleDOMEvents","eventOperation","name","handleEvent","eventType","some","handler","CustomOptions","OptionsConstructor","_super","startX","startY","scrollX","scrollY","freeScroll","directionLockThreshold","eventPassthrough","bottom","right","bounceTime","momentum","momentumLimitTime","momentumLimitDistance","swipeTime","swipeBounceTime","deceleration","flickLimitTime","flickLimitDistance","resizePolling","probeType","stopPropagation","preventDefault","preventDefaultException","tagName","tagException","HWCompositing","useTransition","bindToWrapper","bindToTarget","disableMouse","disableTouch","autoBlur","autoEndDistance","outOfBoundaryDampingFactor","specifiedIndexAsContent","quadrant","merge","options","resolveBounce","process","translateZ","bounceOptions","DEFAULT_BOUNCE","NEGATED_BOUNCE","ActionsHandler","hooks","_a","wrapperEvents","targetEvents","shouldRegisterTouch","shouldRegisterMouse","bind","start","move","end","wrapperEventRegister","targetEventRegister","beforeHandler","preventDefaultConditions","setInitiated","initiated","_eventType","button","beforeStart","point","touches","pointX","pointY","deltaX","deltaY","scrollLeft","documentElement","pageXOffset","body","scrollTop","pageYOffset","pX","pY","clientWidth","clientHeight","setContent","content","rebindDOMEvents","translaterMetaData","y","Translater","getComputedPosition","cssStyle","getComputedStyle","matrix","translate","transformStyle","transformFnName","transformFnArgUnit","transformFnArg","beforeTranslate","join","Base","translater","timer","endPoint","setPending","pending","setForceStopped","forceStopped","setCallStop","called","callStopWhenPending","stop","clearTimer","isValidPostion","startPoint","currentPos","prePos","computeDirection","endValue","startValue","delta","direction","directionX","directionY","Transition","startProbe","probe","pos","transitionTime","time","easing","timeFunction","easingFn","isRealtimeProbeType","_reflow","doStop","forceStop","stopFromTransition","callStop","Animation","animate","duration","startTime","destTime","step","newPoint","stopFromAnimation","createAnimater","element","animaterOptions","Behavior","refresh","dist","setMovingDirection","setDirection","hasScroll","performDampingAlgorithm","movingDirection","dampingFactor","newPos","minScrollPos","maxScrollPos","bounces","momentumInfo","absDist","Math","abs","startPos","wrapperSize","destination","current","lowerMargin","upperMargin","distance","speed","momentumData","rate","round","updateDirection","absStartPos","size","position","isWrapperStatic","wrapperRect","contentRect","contentSize","relativeOffset","computeBoundary","resetState","resetStartPos","beforeComputeBoundary","boundary","scrollable","updatePosition","getCurrentPos","checkInBoundary","adjustPosition","inBoundary","ignoreHasScroll","updateStartPos","updateAbsStartPos","getAbsDist","_b","_c","_d","PassthroughHandlers","DirectionMap","DirectionLockAction","reset","directionLocked","checkMovingDirection","absDistX","absDistY","computeDirectionLock","handleEventPassthrough","adjustDelta","handleMap","applyQuadrantTransformation","ScrollerActions","scrollBehaviorX","scrollBehaviorY","actionsHandler","animater","directionLockAction","enabled","bindActionsHandler","handleStart","transformateDeltaX","transformateDeltaY","transformateDeltaData","coordinateTransformation","handleMove","handleEnd","handleClick","timestamp","fingerMoved","contentMoved","beforeMove","checkMomentum","prevX","newX","prevY","newY","detectMovingDirection","positionChanged","contentNotMoved","scrollStart","dispatchScroll","scroll","endTime","beforeEnd","ensureIntegerPos","scrollEnd","ensuringInteger","minScrollPosX","maxScrollPosX","minScrollPosY","maxScrollPosY","ceil","floor","createActionsHandlerOptions","bsOptions","reduce","prev","cur","createBehaviorOptions","extraProp","bubbling","sourceEvent","targetEvent","isSamePoint","keys_1","MIN_SCROLL_DISTANCE","Scroller","resizeTimeout","actions","resizeHandler","resize","resizeRegister","registerTransitionEnd","init","bindTranslater","bindAnimater","bindActions","togglePointerEvents","transitionEndRegister","prevPos","updatePositions","resetPosition","beforeScrollStart","touchEnd","scrollCancel","checkClick","checkFlick","flick","flickMinMovingDistance","meta","swiper","momentumX","momentumY","scrollTo","preventClick","_dblclick","dblclickTrigged","lastClickTime","delay","children","pointerEvents","node","isBScrollContainer","contentChanged","beforeRefresh","wrapperOffset","scrollBy","extraTransform","minDistanceScroll","scrollToElement","offsetX","offsetY","targetEle","getOffset","getPos","wrapperPos","scrollBehavior","xInBoundary","yInBoundary","reflow","enable","disable","BScrollConstructor","plugins","valid","use","ctor","pluginName","installed","plugin","pluginsMap","applyOrder","scroller","eventBubbling","handleAutoBlur","proxy","applyPlugins","refreshWithoutReset","beforeInitialScrollTo","sort","applyOrderMap","aOrder","bOrder","activeElement","blur","eventRegister","createBScroll","bs","BScroll"],"sources":["/Users/bujidefeng/Desktop/Vue_Code/17 mall/supermall/node_modules/@better-scroll/core/dist/core.esm.js"],"sourcesContent":["/*!\n * better-scroll / core\n * (c) 2016-2021 ustbhuangyi\n * Released under the MIT License.\n */\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nfunction __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nvar __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\n\r\nfunction __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\n\nvar propertiesConfig = [\r\n    {\r\n        sourceKey: 'scroller.scrollBehaviorX.currentPos',\r\n        key: 'x'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollBehaviorY.currentPos',\r\n        key: 'y'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollBehaviorX.hasScroll',\r\n        key: 'hasHorizontalScroll'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollBehaviorY.hasScroll',\r\n        key: 'hasVerticalScroll'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollBehaviorX.contentSize',\r\n        key: 'scrollerWidth'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollBehaviorY.contentSize',\r\n        key: 'scrollerHeight'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollBehaviorX.maxScrollPos',\r\n        key: 'maxScrollX'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollBehaviorY.maxScrollPos',\r\n        key: 'maxScrollY'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollBehaviorX.minScrollPos',\r\n        key: 'minScrollX'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollBehaviorY.minScrollPos',\r\n        key: 'minScrollY'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollBehaviorX.movingDirection',\r\n        key: 'movingDirectionX'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollBehaviorY.movingDirection',\r\n        key: 'movingDirectionY'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollBehaviorX.direction',\r\n        key: 'directionX'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollBehaviorY.direction',\r\n        key: 'directionY'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.actions.enabled',\r\n        key: 'enabled'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.animater.pending',\r\n        key: 'pending'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.animater.stop',\r\n        key: 'stop'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollTo',\r\n        key: 'scrollTo'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollBy',\r\n        key: 'scrollBy'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.scrollToElement',\r\n        key: 'scrollToElement'\r\n    },\r\n    {\r\n        sourceKey: 'scroller.resetPosition',\r\n        key: 'resetPosition'\r\n    }\r\n];\n\nfunction warn(msg) {\r\n    console.error(\"[BScroll warn]: \" + msg);\r\n}\n\n// ssr support\r\nvar inBrowser = typeof window !== 'undefined';\r\nvar ua = inBrowser && navigator.userAgent.toLowerCase();\r\nvar isWeChatDevTools = !!(ua && /wechatdevtools/.test(ua));\r\nvar isAndroid = ua && ua.indexOf('android') > 0;\r\n/* istanbul ignore next */\r\nvar isIOSBadVersion = (function () {\r\n    if (typeof ua === 'string') {\r\n        var regex = /os (\\d\\d?_\\d(_\\d)?)/;\r\n        var matches = regex.exec(ua);\r\n        if (!matches)\r\n            return false;\r\n        var parts = matches[1].split('_').map(function (item) {\r\n            return parseInt(item, 10);\r\n        });\r\n        // ios version >= 13.4 issue 982\r\n        return !!(parts[0] === 13 && parts[1] >= 4);\r\n    }\r\n    return false;\r\n})();\r\n/* istanbul ignore next */\r\nvar supportsPassive = false;\r\n/* istanbul ignore next */\r\nif (inBrowser) {\r\n    var EventName = 'test-passive';\r\n    try {\r\n        var opts = {};\r\n        Object.defineProperty(opts, 'passive', {\r\n            get: function () {\r\n                supportsPassive = true;\r\n            },\r\n        }); // https://github.com/facebook/flow/issues/285\r\n        window.addEventListener(EventName, function () { }, opts);\r\n    }\r\n    catch (e) { }\r\n}\n\nfunction getNow() {\r\n    return window.performance &&\r\n        window.performance.now &&\r\n        window.performance.timing\r\n        ? window.performance.now() + window.performance.timing.navigationStart\r\n        : +new Date();\r\n}\r\nvar extend = function (target, source) {\r\n    for (var key in source) {\r\n        target[key] = source[key];\r\n    }\r\n    return target;\r\n};\r\nfunction isUndef(v) {\r\n    return v === undefined || v === null;\r\n}\r\nfunction between(x, min, max) {\r\n    if (x < min) {\r\n        return min;\r\n    }\r\n    if (x > max) {\r\n        return max;\r\n    }\r\n    return x;\r\n}\n\nvar elementStyle = (inBrowser &&\r\n    document.createElement('div').style);\r\nvar vendor = (function () {\r\n    /* istanbul ignore if  */\r\n    if (!inBrowser) {\r\n        return false;\r\n    }\r\n    var transformNames = [\r\n        {\r\n            key: 'standard',\r\n            value: 'transform',\r\n        },\r\n        {\r\n            key: 'webkit',\r\n            value: 'webkitTransform',\r\n        },\r\n        {\r\n            key: 'Moz',\r\n            value: 'MozTransform',\r\n        },\r\n        {\r\n            key: 'O',\r\n            value: 'OTransform',\r\n        },\r\n        {\r\n            key: 'ms',\r\n            value: 'msTransform',\r\n        },\r\n    ];\r\n    for (var _i = 0, transformNames_1 = transformNames; _i < transformNames_1.length; _i++) {\r\n        var obj = transformNames_1[_i];\r\n        if (elementStyle[obj.value] !== undefined) {\r\n            return obj.key;\r\n        }\r\n    }\r\n    /* istanbul ignore next  */\r\n    return false;\r\n})();\r\n/* istanbul ignore next  */\r\nfunction prefixStyle(style) {\r\n    if (vendor === false) {\r\n        return style;\r\n    }\r\n    if (vendor === 'standard') {\r\n        if (style === 'transitionEnd') {\r\n            return 'transitionend';\r\n        }\r\n        return style;\r\n    }\r\n    return vendor + style.charAt(0).toUpperCase() + style.substr(1);\r\n}\r\nfunction getElement(el) {\r\n    return (typeof el === 'string'\r\n        ? document.querySelector(el)\r\n        : el);\r\n}\r\nfunction addEvent(el, type, fn, capture) {\r\n    var useCapture = supportsPassive\r\n        ? {\r\n            passive: false,\r\n            capture: !!capture,\r\n        }\r\n        : !!capture;\r\n    el.addEventListener(type, fn, useCapture);\r\n}\r\nfunction removeEvent(el, type, fn, capture) {\r\n    el.removeEventListener(type, fn, {\r\n        capture: !!capture,\r\n    });\r\n}\r\nfunction offset(el) {\r\n    var left = 0;\r\n    var top = 0;\r\n    while (el) {\r\n        left -= el.offsetLeft;\r\n        top -= el.offsetTop;\r\n        el = el.offsetParent;\r\n    }\r\n    return {\r\n        left: left,\r\n        top: top,\r\n    };\r\n}\r\nvendor && vendor !== 'standard' ? '-' + vendor.toLowerCase() + '-' : '';\r\nvar transform = prefixStyle('transform');\r\nvar transition = prefixStyle('transition');\r\nvar hasPerspective = inBrowser && prefixStyle('perspective') in elementStyle;\r\n// fix issue #361\r\nvar hasTouch = inBrowser && ('ontouchstart' in window || isWeChatDevTools);\r\nvar hasTransition = inBrowser && transition in elementStyle;\r\nvar style = {\r\n    transform: transform,\r\n    transition: transition,\r\n    transitionTimingFunction: prefixStyle('transitionTimingFunction'),\r\n    transitionDuration: prefixStyle('transitionDuration'),\r\n    transitionDelay: prefixStyle('transitionDelay'),\r\n    transformOrigin: prefixStyle('transformOrigin'),\r\n    transitionEnd: prefixStyle('transitionEnd'),\r\n    transitionProperty: prefixStyle('transitionProperty'),\r\n};\r\nvar eventTypeMap = {\r\n    touchstart: 1,\r\n    touchmove: 1,\r\n    touchend: 1,\r\n    touchcancel: 1,\r\n    mousedown: 2,\r\n    mousemove: 2,\r\n    mouseup: 2,\r\n};\r\nfunction getRect(el) {\r\n    /* istanbul ignore if  */\r\n    if (el instanceof window.SVGElement) {\r\n        var rect = el.getBoundingClientRect();\r\n        return {\r\n            top: rect.top,\r\n            left: rect.left,\r\n            width: rect.width,\r\n            height: rect.height,\r\n        };\r\n    }\r\n    else {\r\n        return {\r\n            top: el.offsetTop,\r\n            left: el.offsetLeft,\r\n            width: el.offsetWidth,\r\n            height: el.offsetHeight,\r\n        };\r\n    }\r\n}\r\nfunction preventDefaultExceptionFn(el, exceptions) {\r\n    for (var i in exceptions) {\r\n        if (exceptions[i].test(el[i])) {\r\n            return true;\r\n        }\r\n    }\r\n    return false;\r\n}\r\nvar tagExceptionFn = preventDefaultExceptionFn;\r\nfunction tap(e, eventName) {\r\n    var ev = document.createEvent('Event');\r\n    ev.initEvent(eventName, true, true);\r\n    ev.pageX = e.pageX;\r\n    ev.pageY = e.pageY;\r\n    e.target.dispatchEvent(ev);\r\n}\r\nfunction click(e, event) {\r\n    if (event === void 0) { event = 'click'; }\r\n    var eventSource;\r\n    if (e.type === 'mouseup') {\r\n        eventSource = e;\r\n    }\r\n    else if (e.type === 'touchend' || e.type === 'touchcancel') {\r\n        eventSource = e.changedTouches[0];\r\n    }\r\n    var posSrc = {};\r\n    if (eventSource) {\r\n        posSrc.screenX = eventSource.screenX || 0;\r\n        posSrc.screenY = eventSource.screenY || 0;\r\n        posSrc.clientX = eventSource.clientX || 0;\r\n        posSrc.clientY = eventSource.clientY || 0;\r\n    }\r\n    var ev;\r\n    var bubbles = true;\r\n    var cancelable = true;\r\n    var ctrlKey = e.ctrlKey, shiftKey = e.shiftKey, altKey = e.altKey, metaKey = e.metaKey;\r\n    var pressedKeysMap = {\r\n        ctrlKey: ctrlKey,\r\n        shiftKey: shiftKey,\r\n        altKey: altKey,\r\n        metaKey: metaKey,\r\n    };\r\n    if (typeof MouseEvent !== 'undefined') {\r\n        try {\r\n            ev = new MouseEvent(event, extend(__assign({ bubbles: bubbles,\r\n                cancelable: cancelable }, pressedKeysMap), posSrc));\r\n        }\r\n        catch (e) {\r\n            /* istanbul ignore next */\r\n            createEvent();\r\n        }\r\n    }\r\n    else {\r\n        createEvent();\r\n    }\r\n    function createEvent() {\r\n        ev = document.createEvent('Event');\r\n        ev.initEvent(event, bubbles, cancelable);\r\n        extend(ev, posSrc);\r\n    }\r\n    // forwardedTouchEvent set to true in case of the conflict with fastclick\r\n    ev.forwardedTouchEvent = true;\r\n    ev._constructed = true;\r\n    e.target.dispatchEvent(ev);\r\n}\r\nfunction dblclick(e) {\r\n    click(e, 'dblclick');\r\n}\n\nvar ease = {\r\n    // easeOutQuint\r\n    swipe: {\r\n        style: 'cubic-bezier(0.23, 1, 0.32, 1)',\r\n        fn: function (t) {\r\n            return 1 + --t * t * t * t * t;\r\n        }\r\n    },\r\n    // easeOutQuard\r\n    swipeBounce: {\r\n        style: 'cubic-bezier(0.25, 0.46, 0.45, 0.94)',\r\n        fn: function (t) {\r\n            return t * (2 - t);\r\n        }\r\n    },\r\n    // easeOutQuart\r\n    bounce: {\r\n        style: 'cubic-bezier(0.165, 0.84, 0.44, 1)',\r\n        fn: function (t) {\r\n            return 1 - --t * t * t * t;\r\n        }\r\n    }\r\n};\n\nvar DEFAULT_INTERVAL = 1000 / 60;\r\nvar windowCompat = inBrowser && window;\r\n/* istanbul ignore next */\r\nfunction noop$1() { }\r\nvar requestAnimationFrame = (function () {\r\n    /* istanbul ignore if  */\r\n    if (!inBrowser) {\r\n        return noop$1;\r\n    }\r\n    return (windowCompat.requestAnimationFrame ||\r\n        windowCompat.webkitRequestAnimationFrame ||\r\n        windowCompat.mozRequestAnimationFrame ||\r\n        windowCompat.oRequestAnimationFrame ||\r\n        // if all else fails, use setTimeout\r\n        function (callback) {\r\n            return window.setTimeout(callback, callback.interval || DEFAULT_INTERVAL); // make interval as precise as possible.\r\n        });\r\n})();\r\nvar cancelAnimationFrame = (function () {\r\n    /* istanbul ignore if  */\r\n    if (!inBrowser) {\r\n        return noop$1;\r\n    }\r\n    return (windowCompat.cancelAnimationFrame ||\r\n        windowCompat.webkitCancelAnimationFrame ||\r\n        windowCompat.mozCancelAnimationFrame ||\r\n        windowCompat.oCancelAnimationFrame ||\r\n        function (id) {\r\n            window.clearTimeout(id);\r\n        });\r\n})();\n\n/* istanbul ignore next */\r\nvar noop = function (val) { };\r\nvar sharedPropertyDefinition = {\r\n    enumerable: true,\r\n    configurable: true,\r\n    get: noop,\r\n    set: noop,\r\n};\r\nvar getProperty = function (obj, key) {\r\n    var keys = key.split('.');\r\n    for (var i = 0; i < keys.length - 1; i++) {\r\n        obj = obj[keys[i]];\r\n        if (typeof obj !== 'object' || !obj)\r\n            return;\r\n    }\r\n    var lastKey = keys.pop();\r\n    if (typeof obj[lastKey] === 'function') {\r\n        return function () {\r\n            return obj[lastKey].apply(obj, arguments);\r\n        };\r\n    }\r\n    else {\r\n        return obj[lastKey];\r\n    }\r\n};\r\nvar setProperty = function (obj, key, value) {\r\n    var keys = key.split('.');\r\n    var temp;\r\n    for (var i = 0; i < keys.length - 1; i++) {\r\n        temp = keys[i];\r\n        if (!obj[temp])\r\n            obj[temp] = {};\r\n        obj = obj[temp];\r\n    }\r\n    obj[keys.pop()] = value;\r\n};\r\nfunction propertiesProxy(target, sourceKey, key) {\r\n    sharedPropertyDefinition.get = function proxyGetter() {\r\n        return getProperty(this, sourceKey);\r\n    };\r\n    sharedPropertyDefinition.set = function proxySetter(val) {\r\n        setProperty(this, sourceKey, val);\r\n    };\r\n    Object.defineProperty(target, key, sharedPropertyDefinition);\r\n}\n\nvar EventEmitter = /** @class */ (function () {\r\n    function EventEmitter(names) {\r\n        this.events = {};\r\n        this.eventTypes = {};\r\n        this.registerType(names);\r\n    }\r\n    EventEmitter.prototype.on = function (type, fn, context) {\r\n        if (context === void 0) { context = this; }\r\n        this.hasType(type);\r\n        if (!this.events[type]) {\r\n            this.events[type] = [];\r\n        }\r\n        this.events[type].push([fn, context]);\r\n        return this;\r\n    };\r\n    EventEmitter.prototype.once = function (type, fn, context) {\r\n        var _this = this;\r\n        if (context === void 0) { context = this; }\r\n        this.hasType(type);\r\n        var magic = function () {\r\n            var args = [];\r\n            for (var _i = 0; _i < arguments.length; _i++) {\r\n                args[_i] = arguments[_i];\r\n            }\r\n            _this.off(type, magic);\r\n            var ret = fn.apply(context, args);\r\n            if (ret === true) {\r\n                return ret;\r\n            }\r\n        };\r\n        magic.fn = fn;\r\n        this.on(type, magic);\r\n        return this;\r\n    };\r\n    EventEmitter.prototype.off = function (type, fn) {\r\n        if (!type && !fn) {\r\n            this.events = {};\r\n            return this;\r\n        }\r\n        if (type) {\r\n            this.hasType(type);\r\n            if (!fn) {\r\n                this.events[type] = [];\r\n                return this;\r\n            }\r\n            var events = this.events[type];\r\n            if (!events) {\r\n                return this;\r\n            }\r\n            var count = events.length;\r\n            while (count--) {\r\n                if (events[count][0] === fn ||\r\n                    (events[count][0] && events[count][0].fn === fn)) {\r\n                    events.splice(count, 1);\r\n                }\r\n            }\r\n            return this;\r\n        }\r\n    };\r\n    EventEmitter.prototype.trigger = function (type) {\r\n        var args = [];\r\n        for (var _i = 1; _i < arguments.length; _i++) {\r\n            args[_i - 1] = arguments[_i];\r\n        }\r\n        this.hasType(type);\r\n        var events = this.events[type];\r\n        if (!events) {\r\n            return;\r\n        }\r\n        var len = events.length;\r\n        var eventsCopy = __spreadArrays(events);\r\n        var ret;\r\n        for (var i = 0; i < len; i++) {\r\n            var event_1 = eventsCopy[i];\r\n            var fn = event_1[0], context = event_1[1];\r\n            if (fn) {\r\n                ret = fn.apply(context, args);\r\n                if (ret === true) {\r\n                    return ret;\r\n                }\r\n            }\r\n        }\r\n    };\r\n    EventEmitter.prototype.registerType = function (names) {\r\n        var _this = this;\r\n        names.forEach(function (type) {\r\n            _this.eventTypes[type] = type;\r\n        });\r\n    };\r\n    EventEmitter.prototype.destroy = function () {\r\n        this.events = {};\r\n        this.eventTypes = {};\r\n    };\r\n    EventEmitter.prototype.hasType = function (type) {\r\n        var types = this.eventTypes;\r\n        var isType = types[type] === type;\r\n        if (!isType) {\r\n            warn(\"EventEmitter has used unknown event type: \\\"\" + type + \"\\\", should be oneof [\" +\r\n                (\"\" + Object.keys(types).map(function (_) { return JSON.stringify(_); })) +\r\n                \"]\");\r\n        }\r\n    };\r\n    return EventEmitter;\r\n}());\r\nvar EventRegister = /** @class */ (function () {\r\n    function EventRegister(wrapper, events) {\r\n        this.wrapper = wrapper;\r\n        this.events = events;\r\n        this.addDOMEvents();\r\n    }\r\n    EventRegister.prototype.destroy = function () {\r\n        this.removeDOMEvents();\r\n        this.events = [];\r\n    };\r\n    EventRegister.prototype.addDOMEvents = function () {\r\n        this.handleDOMEvents(addEvent);\r\n    };\r\n    EventRegister.prototype.removeDOMEvents = function () {\r\n        this.handleDOMEvents(removeEvent);\r\n    };\r\n    EventRegister.prototype.handleDOMEvents = function (eventOperation) {\r\n        var _this = this;\r\n        var wrapper = this.wrapper;\r\n        this.events.forEach(function (event) {\r\n            eventOperation(wrapper, event.name, _this, !!event.capture);\r\n        });\r\n    };\r\n    EventRegister.prototype.handleEvent = function (e) {\r\n        var eventType = e.type;\r\n        this.events.some(function (event) {\r\n            if (event.name === eventType) {\r\n                event.handler(e);\r\n                return true;\r\n            }\r\n            return false;\r\n        });\r\n    };\r\n    return EventRegister;\r\n}());\n\nvar CustomOptions = /** @class */ (function () {\r\n    function CustomOptions() {\r\n    }\r\n    return CustomOptions;\r\n}());\r\nvar OptionsConstructor = /** @class */ (function (_super) {\r\n    __extends(OptionsConstructor, _super);\r\n    function OptionsConstructor() {\r\n        var _this = _super.call(this) || this;\r\n        _this.startX = 0;\r\n        _this.startY = 0;\r\n        _this.scrollX = false;\r\n        _this.scrollY = true;\r\n        _this.freeScroll = false;\r\n        _this.directionLockThreshold = 0;\r\n        _this.eventPassthrough = \"\" /* None */;\r\n        _this.click = false;\r\n        _this.dblclick = false;\r\n        _this.tap = '';\r\n        _this.bounce = {\r\n            top: true,\r\n            bottom: true,\r\n            left: true,\r\n            right: true,\r\n        };\r\n        _this.bounceTime = 800;\r\n        _this.momentum = true;\r\n        _this.momentumLimitTime = 300;\r\n        _this.momentumLimitDistance = 15;\r\n        _this.swipeTime = 2500;\r\n        _this.swipeBounceTime = 500;\r\n        _this.deceleration = 0.0015;\r\n        _this.flickLimitTime = 200;\r\n        _this.flickLimitDistance = 100;\r\n        _this.resizePolling = 60;\r\n        _this.probeType = 0 /* Default */;\r\n        _this.stopPropagation = false;\r\n        _this.preventDefault = true;\r\n        _this.preventDefaultException = {\r\n            tagName: /^(INPUT|TEXTAREA|BUTTON|SELECT|AUDIO)$/,\r\n        };\r\n        _this.tagException = {\r\n            tagName: /^TEXTAREA$/,\r\n        };\r\n        _this.HWCompositing = true;\r\n        _this.useTransition = true;\r\n        _this.bindToWrapper = false;\r\n        _this.bindToTarget = false;\r\n        _this.disableMouse = hasTouch;\r\n        _this.disableTouch = !hasTouch;\r\n        _this.autoBlur = true;\r\n        _this.autoEndDistance = 5;\r\n        _this.outOfBoundaryDampingFactor = 1 / 3;\r\n        _this.specifiedIndexAsContent = 0;\r\n        _this.quadrant = 1 /* First */;\r\n        return _this;\r\n    }\r\n    OptionsConstructor.prototype.merge = function (options) {\r\n        if (!options)\r\n            return this;\r\n        for (var key in options) {\r\n            if (key === 'bounce') {\r\n                this.bounce = this.resolveBounce(options[key]);\r\n                continue;\r\n            }\r\n            this[key] = options[key];\r\n        }\r\n        return this;\r\n    };\r\n    OptionsConstructor.prototype.process = function () {\r\n        this.translateZ =\r\n            this.HWCompositing && hasPerspective ? ' translateZ(1px)' : '';\r\n        this.useTransition = this.useTransition && hasTransition;\r\n        this.preventDefault = !this.eventPassthrough && this.preventDefault;\r\n        // If you want eventPassthrough I have to lock one of the axes\r\n        this.scrollX =\r\n            this.eventPassthrough === \"horizontal\" /* Horizontal */\r\n                ? false\r\n                : this.scrollX;\r\n        this.scrollY =\r\n            this.eventPassthrough === \"vertical\" /* Vertical */ ? false : this.scrollY;\r\n        // With eventPassthrough we also need lockDirection mechanism\r\n        this.freeScroll = this.freeScroll && !this.eventPassthrough;\r\n        // force true when freeScroll is true\r\n        this.scrollX = this.freeScroll ? true : this.scrollX;\r\n        this.scrollY = this.freeScroll ? true : this.scrollY;\r\n        this.directionLockThreshold = this.eventPassthrough\r\n            ? 0\r\n            : this.directionLockThreshold;\r\n        return this;\r\n    };\r\n    OptionsConstructor.prototype.resolveBounce = function (bounceOptions) {\r\n        var DEFAULT_BOUNCE = {\r\n            top: true,\r\n            right: true,\r\n            bottom: true,\r\n            left: true,\r\n        };\r\n        var NEGATED_BOUNCE = {\r\n            top: false,\r\n            right: false,\r\n            bottom: false,\r\n            left: false,\r\n        };\r\n        var ret;\r\n        if (typeof bounceOptions === 'object') {\r\n            ret = extend(DEFAULT_BOUNCE, bounceOptions);\r\n        }\r\n        else {\r\n            ret = bounceOptions ? DEFAULT_BOUNCE : NEGATED_BOUNCE;\r\n        }\r\n        return ret;\r\n    };\r\n    return OptionsConstructor;\r\n}(CustomOptions));\n\nvar ActionsHandler = /** @class */ (function () {\r\n    function ActionsHandler(wrapper, options) {\r\n        this.wrapper = wrapper;\r\n        this.options = options;\r\n        this.hooks = new EventEmitter([\r\n            'beforeStart',\r\n            'start',\r\n            'move',\r\n            'end',\r\n            'click',\r\n        ]);\r\n        this.handleDOMEvents();\r\n    }\r\n    ActionsHandler.prototype.handleDOMEvents = function () {\r\n        var _a = this.options, bindToWrapper = _a.bindToWrapper, disableMouse = _a.disableMouse, disableTouch = _a.disableTouch, click = _a.click;\r\n        var wrapper = this.wrapper;\r\n        var target = bindToWrapper ? wrapper : window;\r\n        var wrapperEvents = [];\r\n        var targetEvents = [];\r\n        var shouldRegisterTouch = !disableTouch;\r\n        var shouldRegisterMouse = !disableMouse;\r\n        if (click) {\r\n            wrapperEvents.push({\r\n                name: 'click',\r\n                handler: this.click.bind(this),\r\n                capture: true,\r\n            });\r\n        }\r\n        if (shouldRegisterTouch) {\r\n            wrapperEvents.push({\r\n                name: 'touchstart',\r\n                handler: this.start.bind(this),\r\n            });\r\n            targetEvents.push({\r\n                name: 'touchmove',\r\n                handler: this.move.bind(this),\r\n            }, {\r\n                name: 'touchend',\r\n                handler: this.end.bind(this),\r\n            }, {\r\n                name: 'touchcancel',\r\n                handler: this.end.bind(this),\r\n            });\r\n        }\r\n        if (shouldRegisterMouse) {\r\n            wrapperEvents.push({\r\n                name: 'mousedown',\r\n                handler: this.start.bind(this),\r\n            });\r\n            targetEvents.push({\r\n                name: 'mousemove',\r\n                handler: this.move.bind(this),\r\n            }, {\r\n                name: 'mouseup',\r\n                handler: this.end.bind(this),\r\n            });\r\n        }\r\n        this.wrapperEventRegister = new EventRegister(wrapper, wrapperEvents);\r\n        this.targetEventRegister = new EventRegister(target, targetEvents);\r\n    };\r\n    ActionsHandler.prototype.beforeHandler = function (e, type) {\r\n        var _a = this.options, preventDefault = _a.preventDefault, stopPropagation = _a.stopPropagation, preventDefaultException = _a.preventDefaultException;\r\n        var preventDefaultConditions = {\r\n            start: function () {\r\n                return (preventDefault &&\r\n                    !preventDefaultExceptionFn(e.target, preventDefaultException));\r\n            },\r\n            end: function () {\r\n                return (preventDefault &&\r\n                    !preventDefaultExceptionFn(e.target, preventDefaultException));\r\n            },\r\n            move: function () {\r\n                return preventDefault;\r\n            },\r\n        };\r\n        if (preventDefaultConditions[type]()) {\r\n            e.preventDefault();\r\n        }\r\n        if (stopPropagation) {\r\n            e.stopPropagation();\r\n        }\r\n    };\r\n    ActionsHandler.prototype.setInitiated = function (type) {\r\n        if (type === void 0) { type = 0; }\r\n        this.initiated = type;\r\n    };\r\n    ActionsHandler.prototype.start = function (e) {\r\n        var _eventType = eventTypeMap[e.type];\r\n        if (this.initiated && this.initiated !== _eventType) {\r\n            return;\r\n        }\r\n        this.setInitiated(_eventType);\r\n        // if textarea or other html tags in options.tagException is manipulated\r\n        // do not make bs scroll\r\n        if (tagExceptionFn(e.target, this.options.tagException)) {\r\n            this.setInitiated();\r\n            return;\r\n        }\r\n        // only allow mouse left button\r\n        if (_eventType === 2 /* Mouse */ && e.button !== 0 /* Left */)\r\n            return;\r\n        if (this.hooks.trigger(this.hooks.eventTypes.beforeStart, e)) {\r\n            return;\r\n        }\r\n        this.beforeHandler(e, 'start');\r\n        var point = (e.touches ? e.touches[0] : e);\r\n        this.pointX = point.pageX;\r\n        this.pointY = point.pageY;\r\n        this.hooks.trigger(this.hooks.eventTypes.start, e);\r\n    };\r\n    ActionsHandler.prototype.move = function (e) {\r\n        if (eventTypeMap[e.type] !== this.initiated) {\r\n            return;\r\n        }\r\n        this.beforeHandler(e, 'move');\r\n        var point = (e.touches ? e.touches[0] : e);\r\n        var deltaX = point.pageX - this.pointX;\r\n        var deltaY = point.pageY - this.pointY;\r\n        this.pointX = point.pageX;\r\n        this.pointY = point.pageY;\r\n        if (this.hooks.trigger(this.hooks.eventTypes.move, {\r\n            deltaX: deltaX,\r\n            deltaY: deltaY,\r\n            e: e,\r\n        })) {\r\n            return;\r\n        }\r\n        // auto end when out of viewport\r\n        var scrollLeft = document.documentElement.scrollLeft ||\r\n            window.pageXOffset ||\r\n            document.body.scrollLeft;\r\n        var scrollTop = document.documentElement.scrollTop ||\r\n            window.pageYOffset ||\r\n            document.body.scrollTop;\r\n        var pX = this.pointX - scrollLeft;\r\n        var pY = this.pointY - scrollTop;\r\n        var autoEndDistance = this.options.autoEndDistance;\r\n        if (pX > document.documentElement.clientWidth - autoEndDistance ||\r\n            pY > document.documentElement.clientHeight - autoEndDistance ||\r\n            pX < autoEndDistance ||\r\n            pY < autoEndDistance) {\r\n            this.end(e);\r\n        }\r\n    };\r\n    ActionsHandler.prototype.end = function (e) {\r\n        if (eventTypeMap[e.type] !== this.initiated) {\r\n            return;\r\n        }\r\n        this.setInitiated();\r\n        this.beforeHandler(e, 'end');\r\n        this.hooks.trigger(this.hooks.eventTypes.end, e);\r\n    };\r\n    ActionsHandler.prototype.click = function (e) {\r\n        this.hooks.trigger(this.hooks.eventTypes.click, e);\r\n    };\r\n    ActionsHandler.prototype.setContent = function (content) {\r\n        if (content !== this.wrapper) {\r\n            this.wrapper = content;\r\n            this.rebindDOMEvents();\r\n        }\r\n    };\r\n    ActionsHandler.prototype.rebindDOMEvents = function () {\r\n        this.wrapperEventRegister.destroy();\r\n        this.targetEventRegister.destroy();\r\n        this.handleDOMEvents();\r\n    };\r\n    ActionsHandler.prototype.destroy = function () {\r\n        this.wrapperEventRegister.destroy();\r\n        this.targetEventRegister.destroy();\r\n        this.hooks.destroy();\r\n    };\r\n    return ActionsHandler;\r\n}());\n\nvar translaterMetaData = {\r\n    x: ['translateX', 'px'],\r\n    y: ['translateY', 'px'],\r\n};\r\nvar Translater = /** @class */ (function () {\r\n    function Translater(content) {\r\n        this.setContent(content);\r\n        this.hooks = new EventEmitter(['beforeTranslate', 'translate']);\r\n    }\r\n    Translater.prototype.getComputedPosition = function () {\r\n        var cssStyle = window.getComputedStyle(this.content, null);\r\n        var matrix = cssStyle[style.transform].split(')')[0].split(', ');\r\n        var x = +(matrix[12] || matrix[4]) || 0;\r\n        var y = +(matrix[13] || matrix[5]) || 0;\r\n        return {\r\n            x: x,\r\n            y: y,\r\n        };\r\n    };\r\n    Translater.prototype.translate = function (point) {\r\n        var transformStyle = [];\r\n        Object.keys(point).forEach(function (key) {\r\n            if (!translaterMetaData[key]) {\r\n                return;\r\n            }\r\n            var transformFnName = translaterMetaData[key][0];\r\n            if (transformFnName) {\r\n                var transformFnArgUnit = translaterMetaData[key][1];\r\n                var transformFnArg = point[key];\r\n                transformStyle.push(transformFnName + \"(\" + transformFnArg + transformFnArgUnit + \")\");\r\n            }\r\n        });\r\n        this.hooks.trigger(this.hooks.eventTypes.beforeTranslate, transformStyle, point);\r\n        this.style[style.transform] = transformStyle.join(' ');\r\n        this.hooks.trigger(this.hooks.eventTypes.translate, point);\r\n    };\r\n    Translater.prototype.setContent = function (content) {\r\n        if (this.content !== content) {\r\n            this.content = content;\r\n            this.style = content.style;\r\n        }\r\n    };\r\n    Translater.prototype.destroy = function () {\r\n        this.hooks.destroy();\r\n    };\r\n    return Translater;\r\n}());\n\nvar Base = /** @class */ (function () {\r\n    function Base(content, translater, options) {\r\n        this.translater = translater;\r\n        this.options = options;\r\n        this.timer = 0;\r\n        this.hooks = new EventEmitter([\r\n            'move',\r\n            'end',\r\n            'beforeForceStop',\r\n            'forceStop',\r\n            'callStop',\r\n            'time',\r\n            'timeFunction',\r\n        ]);\r\n        this.setContent(content);\r\n    }\r\n    Base.prototype.translate = function (endPoint) {\r\n        this.translater.translate(endPoint);\r\n    };\r\n    Base.prototype.setPending = function (pending) {\r\n        this.pending = pending;\r\n    };\r\n    Base.prototype.setForceStopped = function (forceStopped) {\r\n        this.forceStopped = forceStopped;\r\n    };\r\n    Base.prototype.setCallStop = function (called) {\r\n        this.callStopWhenPending = called;\r\n    };\r\n    Base.prototype.setContent = function (content) {\r\n        if (this.content !== content) {\r\n            this.content = content;\r\n            this.style = content.style;\r\n            this.stop();\r\n        }\r\n    };\r\n    Base.prototype.clearTimer = function () {\r\n        if (this.timer) {\r\n            cancelAnimationFrame(this.timer);\r\n            this.timer = 0;\r\n        }\r\n    };\r\n    Base.prototype.destroy = function () {\r\n        this.hooks.destroy();\r\n        cancelAnimationFrame(this.timer);\r\n    };\r\n    return Base;\r\n}());\n\n// iOS 13.6 - 14.x, window.getComputedStyle sometimes will get wrong transform value\r\n// when bs use transition mode\r\n// eg: translateY -100px -> -200px, when the last frame which is about to scroll to -200px\r\n// window.getComputedStyle(this.content) will calculate transformY to be -100px(startPoint)\r\n// it is weird\r\n// so we should validate position caculated by 'window.getComputedStyle'\r\nvar isValidPostion = function (startPoint, endPoint, currentPos, prePos) {\r\n    var computeDirection = function (endValue, startValue) {\r\n        var delta = endValue - startValue;\r\n        var direction = delta > 0\r\n            ? -1 /* Negative */\r\n            : delta < 0\r\n                ? 1 /* Positive */\r\n                : 0 /* Default */;\r\n        return direction;\r\n    };\r\n    var directionX = computeDirection(endPoint.x, startPoint.x);\r\n    var directionY = computeDirection(endPoint.y, startPoint.y);\r\n    var deltaX = currentPos.x - prePos.x;\r\n    var deltaY = currentPos.y - prePos.y;\r\n    return directionX * deltaX <= 0 && directionY * deltaY <= 0;\r\n};\n\nvar Transition = /** @class */ (function (_super) {\r\n    __extends(Transition, _super);\r\n    function Transition() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    Transition.prototype.startProbe = function (startPoint, endPoint) {\r\n        var _this = this;\r\n        var prePos = startPoint;\r\n        var probe = function () {\r\n            var pos = _this.translater.getComputedPosition();\r\n            if (isValidPostion(startPoint, endPoint, pos, prePos)) {\r\n                _this.hooks.trigger(_this.hooks.eventTypes.move, pos);\r\n            }\r\n            // call bs.stop() should not dispatch end hook again.\r\n            // forceStop hook will do this.\r\n            /* istanbul ignore if  */\r\n            if (!_this.pending) {\r\n                if (_this.callStopWhenPending) {\r\n                    _this.callStopWhenPending = false;\r\n                }\r\n                else {\r\n                    // transition ends should dispatch end hook.\r\n                    _this.hooks.trigger(_this.hooks.eventTypes.end, pos);\r\n                }\r\n            }\r\n            prePos = pos;\r\n            if (_this.pending) {\r\n                _this.timer = requestAnimationFrame(probe);\r\n            }\r\n        };\r\n        // when manually call bs.stop(), then bs.scrollTo()\r\n        // we should reset callStopWhenPending to dispatch end hook\r\n        if (this.callStopWhenPending) {\r\n            this.setCallStop(false);\r\n        }\r\n        cancelAnimationFrame(this.timer);\r\n        probe();\r\n    };\r\n    Transition.prototype.transitionTime = function (time) {\r\n        if (time === void 0) { time = 0; }\r\n        this.style[style.transitionDuration] = time + 'ms';\r\n        this.hooks.trigger(this.hooks.eventTypes.time, time);\r\n    };\r\n    Transition.prototype.transitionTimingFunction = function (easing) {\r\n        this.style[style.transitionTimingFunction] = easing;\r\n        this.hooks.trigger(this.hooks.eventTypes.timeFunction, easing);\r\n    };\r\n    Transition.prototype.transitionProperty = function () {\r\n        this.style[style.transitionProperty] = style.transform;\r\n    };\r\n    Transition.prototype.move = function (startPoint, endPoint, time, easingFn) {\r\n        this.setPending(time > 0);\r\n        this.transitionTimingFunction(easingFn);\r\n        this.transitionProperty();\r\n        this.transitionTime(time);\r\n        this.translate(endPoint);\r\n        var isRealtimeProbeType = this.options.probeType === 3 /* Realtime */;\r\n        if (time && isRealtimeProbeType) {\r\n            this.startProbe(startPoint, endPoint);\r\n        }\r\n        // if we change content's transformY in a tick\r\n        // such as: 0 -> 50px -> 0\r\n        // transitionend will not be triggered\r\n        // so we forceupdate by reflow\r\n        if (!time) {\r\n            this._reflow = this.content.offsetHeight;\r\n            if (isRealtimeProbeType) {\r\n                this.hooks.trigger(this.hooks.eventTypes.move, endPoint);\r\n            }\r\n            this.hooks.trigger(this.hooks.eventTypes.end, endPoint);\r\n        }\r\n    };\r\n    Transition.prototype.doStop = function () {\r\n        var pending = this.pending;\r\n        this.setForceStopped(false);\r\n        this.setCallStop(false);\r\n        // still in transition\r\n        if (pending) {\r\n            this.setPending(false);\r\n            cancelAnimationFrame(this.timer);\r\n            var _a = this.translater.getComputedPosition(), x = _a.x, y = _a.y;\r\n            this.transitionTime();\r\n            this.translate({ x: x, y: y });\r\n            this.setForceStopped(true);\r\n            this.setCallStop(true);\r\n            this.hooks.trigger(this.hooks.eventTypes.forceStop, { x: x, y: y });\r\n        }\r\n        return pending;\r\n    };\r\n    Transition.prototype.stop = function () {\r\n        var stopFromTransition = this.doStop();\r\n        if (stopFromTransition) {\r\n            this.hooks.trigger(this.hooks.eventTypes.callStop);\r\n        }\r\n    };\r\n    return Transition;\r\n}(Base));\n\nvar Animation = /** @class */ (function (_super) {\r\n    __extends(Animation, _super);\r\n    function Animation() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    Animation.prototype.move = function (startPoint, endPoint, time, easingFn) {\r\n        // time is 0\r\n        if (!time) {\r\n            this.translate(endPoint);\r\n            if (this.options.probeType === 3 /* Realtime */) {\r\n                this.hooks.trigger(this.hooks.eventTypes.move, endPoint);\r\n            }\r\n            this.hooks.trigger(this.hooks.eventTypes.end, endPoint);\r\n            return;\r\n        }\r\n        this.animate(startPoint, endPoint, time, easingFn);\r\n    };\r\n    Animation.prototype.animate = function (startPoint, endPoint, duration, easingFn) {\r\n        var _this = this;\r\n        var startTime = getNow();\r\n        var destTime = startTime + duration;\r\n        var isRealtimeProbeType = this.options.probeType === 3 /* Realtime */;\r\n        var step = function () {\r\n            var now = getNow();\r\n            // js animation end\r\n            if (now >= destTime) {\r\n                _this.translate(endPoint);\r\n                if (isRealtimeProbeType) {\r\n                    _this.hooks.trigger(_this.hooks.eventTypes.move, endPoint);\r\n                }\r\n                _this.hooks.trigger(_this.hooks.eventTypes.end, endPoint);\r\n                return;\r\n            }\r\n            now = (now - startTime) / duration;\r\n            var easing = easingFn(now);\r\n            var newPoint = {};\r\n            Object.keys(endPoint).forEach(function (key) {\r\n                var startValue = startPoint[key];\r\n                var endValue = endPoint[key];\r\n                newPoint[key] = (endValue - startValue) * easing + startValue;\r\n            });\r\n            _this.translate(newPoint);\r\n            if (isRealtimeProbeType) {\r\n                _this.hooks.trigger(_this.hooks.eventTypes.move, newPoint);\r\n            }\r\n            if (_this.pending) {\r\n                _this.timer = requestAnimationFrame(step);\r\n            }\r\n            // call bs.stop() should not dispatch end hook again.\r\n            // forceStop hook will do this.\r\n            /* istanbul ignore if  */\r\n            if (!_this.pending) {\r\n                if (_this.callStopWhenPending) {\r\n                    _this.callStopWhenPending = false;\r\n                }\r\n                else {\r\n                    // raf ends should dispatch end hook.\r\n                    _this.hooks.trigger(_this.hooks.eventTypes.end, endPoint);\r\n                }\r\n            }\r\n        };\r\n        this.setPending(true);\r\n        // when manually call bs.stop(), then bs.scrollTo()\r\n        // we should reset callStopWhenPending to dispatch end hook\r\n        if (this.callStopWhenPending) {\r\n            this.setCallStop(false);\r\n        }\r\n        cancelAnimationFrame(this.timer);\r\n        step();\r\n    };\r\n    Animation.prototype.doStop = function () {\r\n        var pending = this.pending;\r\n        this.setForceStopped(false);\r\n        this.setCallStop(false);\r\n        // still in requestFrameAnimation\r\n        if (pending) {\r\n            this.setPending(false);\r\n            cancelAnimationFrame(this.timer);\r\n            var pos = this.translater.getComputedPosition();\r\n            this.setForceStopped(true);\r\n            this.setCallStop(true);\r\n            this.hooks.trigger(this.hooks.eventTypes.forceStop, pos);\r\n        }\r\n        return pending;\r\n    };\r\n    Animation.prototype.stop = function () {\r\n        var stopFromAnimation = this.doStop();\r\n        if (stopFromAnimation) {\r\n            this.hooks.trigger(this.hooks.eventTypes.callStop);\r\n        }\r\n    };\r\n    return Animation;\r\n}(Base));\n\nfunction createAnimater(element, translater, options) {\r\n    var useTransition = options.useTransition;\r\n    var animaterOptions = {};\r\n    Object.defineProperty(animaterOptions, 'probeType', {\r\n        enumerable: true,\r\n        configurable: false,\r\n        get: function () {\r\n            return options.probeType;\r\n        },\r\n    });\r\n    if (useTransition) {\r\n        return new Transition(element, translater, animaterOptions);\r\n    }\r\n    else {\r\n        return new Animation(element, translater, animaterOptions);\r\n    }\r\n}\n\nvar Behavior = /** @class */ (function () {\r\n    function Behavior(wrapper, content, options) {\r\n        this.wrapper = wrapper;\r\n        this.options = options;\r\n        this.hooks = new EventEmitter([\r\n            'beforeComputeBoundary',\r\n            'computeBoundary',\r\n            'momentum',\r\n            'end',\r\n            'ignoreHasScroll'\r\n        ]);\r\n        this.refresh(content);\r\n    }\r\n    Behavior.prototype.start = function () {\r\n        this.dist = 0;\r\n        this.setMovingDirection(0 /* Default */);\r\n        this.setDirection(0 /* Default */);\r\n    };\r\n    Behavior.prototype.move = function (delta) {\r\n        delta = this.hasScroll ? delta : 0;\r\n        this.setMovingDirection(delta);\r\n        return this.performDampingAlgorithm(delta, this.options.outOfBoundaryDampingFactor);\r\n    };\r\n    Behavior.prototype.setMovingDirection = function (delta) {\r\n        this.movingDirection =\r\n            delta > 0\r\n                ? -1 /* Negative */\r\n                : delta < 0\r\n                    ? 1 /* Positive */\r\n                    : 0 /* Default */;\r\n    };\r\n    Behavior.prototype.setDirection = function (delta) {\r\n        this.direction =\r\n            delta > 0\r\n                ? -1 /* Negative */\r\n                : delta < 0\r\n                    ? 1 /* Positive */\r\n                    : 0 /* Default */;\r\n    };\r\n    Behavior.prototype.performDampingAlgorithm = function (delta, dampingFactor) {\r\n        var newPos = this.currentPos + delta;\r\n        // Slow down or stop if outside of the boundaries\r\n        if (newPos > this.minScrollPos || newPos < this.maxScrollPos) {\r\n            if ((newPos > this.minScrollPos && this.options.bounces[0]) ||\r\n                (newPos < this.maxScrollPos && this.options.bounces[1])) {\r\n                newPos = this.currentPos + delta * dampingFactor;\r\n            }\r\n            else {\r\n                newPos =\r\n                    newPos > this.minScrollPos ? this.minScrollPos : this.maxScrollPos;\r\n            }\r\n        }\r\n        return newPos;\r\n    };\r\n    Behavior.prototype.end = function (duration) {\r\n        var momentumInfo = {\r\n            duration: 0\r\n        };\r\n        var absDist = Math.abs(this.currentPos - this.startPos);\r\n        // start momentum animation if needed\r\n        if (this.options.momentum &&\r\n            duration < this.options.momentumLimitTime &&\r\n            absDist > this.options.momentumLimitDistance) {\r\n            var wrapperSize = (this.direction === -1 /* Negative */ && this.options.bounces[0]) ||\r\n                (this.direction === 1 /* Positive */ && this.options.bounces[1])\r\n                ? this.wrapperSize\r\n                : 0;\r\n            momentumInfo = this.hasScroll\r\n                ? this.momentum(this.currentPos, this.startPos, duration, this.maxScrollPos, this.minScrollPos, wrapperSize, this.options)\r\n                : { destination: this.currentPos, duration: 0 };\r\n        }\r\n        else {\r\n            this.hooks.trigger(this.hooks.eventTypes.end, momentumInfo);\r\n        }\r\n        return momentumInfo;\r\n    };\r\n    Behavior.prototype.momentum = function (current, start, time, lowerMargin, upperMargin, wrapperSize, options) {\r\n        if (options === void 0) { options = this.options; }\r\n        var distance = current - start;\r\n        var speed = Math.abs(distance) / time;\r\n        var deceleration = options.deceleration, swipeBounceTime = options.swipeBounceTime, swipeTime = options.swipeTime;\r\n        var duration = Math.min(swipeTime, (speed * 2) / deceleration);\r\n        var momentumData = {\r\n            destination: current + ((speed * speed) / deceleration) * (distance < 0 ? -1 : 1),\r\n            duration: duration,\r\n            rate: 15\r\n        };\r\n        this.hooks.trigger(this.hooks.eventTypes.momentum, momentumData, distance);\r\n        if (momentumData.destination < lowerMargin) {\r\n            momentumData.destination = wrapperSize\r\n                ? Math.max(lowerMargin - wrapperSize / 4, lowerMargin - (wrapperSize / momentumData.rate) * speed)\r\n                : lowerMargin;\r\n            momentumData.duration = swipeBounceTime;\r\n        }\r\n        else if (momentumData.destination > upperMargin) {\r\n            momentumData.destination = wrapperSize\r\n                ? Math.min(upperMargin + wrapperSize / 4, upperMargin + (wrapperSize / momentumData.rate) * speed)\r\n                : upperMargin;\r\n            momentumData.duration = swipeBounceTime;\r\n        }\r\n        momentumData.destination = Math.round(momentumData.destination);\r\n        return momentumData;\r\n    };\r\n    Behavior.prototype.updateDirection = function () {\r\n        var absDist = this.currentPos - this.absStartPos;\r\n        this.setDirection(absDist);\r\n    };\r\n    Behavior.prototype.refresh = function (content) {\r\n        var _a = this.options.rect, size = _a.size, position = _a.position;\r\n        var isWrapperStatic = window.getComputedStyle(this.wrapper, null).position === 'static';\r\n        // Force reflow\r\n        var wrapperRect = getRect(this.wrapper);\r\n        // use client is more fair than offset\r\n        this.wrapperSize = this.wrapper[size === 'width' ? 'clientWidth' : 'clientHeight'];\r\n        this.setContent(content);\r\n        var contentRect = getRect(this.content);\r\n        this.contentSize = contentRect[size];\r\n        this.relativeOffset = contentRect[position];\r\n        /* istanbul ignore if  */\r\n        if (isWrapperStatic) {\r\n            this.relativeOffset -= wrapperRect[position];\r\n        }\r\n        this.computeBoundary();\r\n        this.setDirection(0 /* Default */);\r\n    };\r\n    Behavior.prototype.setContent = function (content) {\r\n        if (content !== this.content) {\r\n            this.content = content;\r\n            this.resetState();\r\n        }\r\n    };\r\n    Behavior.prototype.resetState = function () {\r\n        this.currentPos = 0;\r\n        this.startPos = 0;\r\n        this.dist = 0;\r\n        this.setDirection(0 /* Default */);\r\n        this.setMovingDirection(0 /* Default */);\r\n        this.resetStartPos();\r\n    };\r\n    Behavior.prototype.computeBoundary = function () {\r\n        this.hooks.trigger(this.hooks.eventTypes.beforeComputeBoundary);\r\n        var boundary = {\r\n            minScrollPos: 0,\r\n            maxScrollPos: this.wrapperSize - this.contentSize\r\n        };\r\n        if (boundary.maxScrollPos < 0) {\r\n            boundary.maxScrollPos -= this.relativeOffset;\r\n            if (this.options.specifiedIndexAsContent === 0) {\r\n                boundary.minScrollPos = -this.relativeOffset;\r\n            }\r\n        }\r\n        this.hooks.trigger(this.hooks.eventTypes.computeBoundary, boundary);\r\n        this.minScrollPos = boundary.minScrollPos;\r\n        this.maxScrollPos = boundary.maxScrollPos;\r\n        this.hasScroll =\r\n            this.options.scrollable && this.maxScrollPos < this.minScrollPos;\r\n        if (!this.hasScroll && this.minScrollPos < this.maxScrollPos) {\r\n            this.maxScrollPos = this.minScrollPos;\r\n            this.contentSize = this.wrapperSize;\r\n        }\r\n    };\r\n    Behavior.prototype.updatePosition = function (pos) {\r\n        this.currentPos = pos;\r\n    };\r\n    Behavior.prototype.getCurrentPos = function () {\r\n        return this.currentPos;\r\n    };\r\n    Behavior.prototype.checkInBoundary = function () {\r\n        var position = this.adjustPosition(this.currentPos);\r\n        var inBoundary = position === this.getCurrentPos();\r\n        return {\r\n            position: position,\r\n            inBoundary: inBoundary\r\n        };\r\n    };\r\n    // adjust position when out of boundary\r\n    Behavior.prototype.adjustPosition = function (pos) {\r\n        if (!this.hasScroll &&\r\n            !this.hooks.trigger(this.hooks.eventTypes.ignoreHasScroll)) {\r\n            pos = this.minScrollPos;\r\n        }\r\n        else if (pos > this.minScrollPos) {\r\n            pos = this.minScrollPos;\r\n        }\r\n        else if (pos < this.maxScrollPos) {\r\n            pos = this.maxScrollPos;\r\n        }\r\n        return pos;\r\n    };\r\n    Behavior.prototype.updateStartPos = function () {\r\n        this.startPos = this.currentPos;\r\n    };\r\n    Behavior.prototype.updateAbsStartPos = function () {\r\n        this.absStartPos = this.currentPos;\r\n    };\r\n    Behavior.prototype.resetStartPos = function () {\r\n        this.updateStartPos();\r\n        this.updateAbsStartPos();\r\n    };\r\n    Behavior.prototype.getAbsDist = function (delta) {\r\n        this.dist += delta;\r\n        return Math.abs(this.dist);\r\n    };\r\n    Behavior.prototype.destroy = function () {\r\n        this.hooks.destroy();\r\n    };\r\n    return Behavior;\r\n}());\n\nvar _a, _b, _c, _d;\r\nvar PassthroughHandlers = (_a = {},\r\n    _a[\"yes\" /* Yes */] = function (e) {\r\n        return true;\r\n    },\r\n    _a[\"no\" /* No */] = function (e) {\r\n        e.preventDefault();\r\n        return false;\r\n    },\r\n    _a);\r\nvar DirectionMap = (_b = {},\r\n    _b[\"horizontal\" /* Horizontal */] = (_c = {},\r\n        _c[\"yes\" /* Yes */] = \"horizontal\" /* Horizontal */,\r\n        _c[\"no\" /* No */] = \"vertical\" /* Vertical */,\r\n        _c),\r\n    _b[\"vertical\" /* Vertical */] = (_d = {},\r\n        _d[\"yes\" /* Yes */] = \"vertical\" /* Vertical */,\r\n        _d[\"no\" /* No */] = \"horizontal\" /* Horizontal */,\r\n        _d),\r\n    _b);\r\nvar DirectionLockAction = /** @class */ (function () {\r\n    function DirectionLockAction(directionLockThreshold, freeScroll, eventPassthrough) {\r\n        this.directionLockThreshold = directionLockThreshold;\r\n        this.freeScroll = freeScroll;\r\n        this.eventPassthrough = eventPassthrough;\r\n        this.reset();\r\n    }\r\n    DirectionLockAction.prototype.reset = function () {\r\n        this.directionLocked = \"\" /* Default */;\r\n    };\r\n    DirectionLockAction.prototype.checkMovingDirection = function (absDistX, absDistY, e) {\r\n        this.computeDirectionLock(absDistX, absDistY);\r\n        return this.handleEventPassthrough(e);\r\n    };\r\n    DirectionLockAction.prototype.adjustDelta = function (deltaX, deltaY) {\r\n        if (this.directionLocked === \"horizontal\" /* Horizontal */) {\r\n            deltaY = 0;\r\n        }\r\n        else if (this.directionLocked === \"vertical\" /* Vertical */) {\r\n            deltaX = 0;\r\n        }\r\n        return {\r\n            deltaX: deltaX,\r\n            deltaY: deltaY\r\n        };\r\n    };\r\n    DirectionLockAction.prototype.computeDirectionLock = function (absDistX, absDistY) {\r\n        // If you are scrolling in one direction, lock it\r\n        if (this.directionLocked === \"\" /* Default */ && !this.freeScroll) {\r\n            if (absDistX > absDistY + this.directionLockThreshold) {\r\n                this.directionLocked = \"horizontal\" /* Horizontal */; // lock horizontally\r\n            }\r\n            else if (absDistY >= absDistX + this.directionLockThreshold) {\r\n                this.directionLocked = \"vertical\" /* Vertical */; // lock vertically\r\n            }\r\n            else {\r\n                this.directionLocked = \"none\" /* None */; // no lock\r\n            }\r\n        }\r\n    };\r\n    DirectionLockAction.prototype.handleEventPassthrough = function (e) {\r\n        var handleMap = DirectionMap[this.directionLocked];\r\n        if (handleMap) {\r\n            if (this.eventPassthrough === handleMap[\"yes\" /* Yes */]) {\r\n                return PassthroughHandlers[\"yes\" /* Yes */](e);\r\n            }\r\n            else if (this.eventPassthrough === handleMap[\"no\" /* No */]) {\r\n                return PassthroughHandlers[\"no\" /* No */](e);\r\n            }\r\n        }\r\n        return false;\r\n    };\r\n    return DirectionLockAction;\r\n}());\n\nvar applyQuadrantTransformation = function (deltaX, deltaY, quadrant) {\r\n    if (quadrant === 2 /* Second */) {\r\n        return [deltaY, -deltaX];\r\n    }\r\n    else if (quadrant === 3 /* Third */) {\r\n        return [-deltaX, -deltaY];\r\n    }\r\n    else if (quadrant === 4 /* Forth */) {\r\n        return [-deltaY, deltaX];\r\n    }\r\n    else {\r\n        return [deltaX, deltaY];\r\n    }\r\n};\r\nvar ScrollerActions = /** @class */ (function () {\r\n    function ScrollerActions(scrollBehaviorX, scrollBehaviorY, actionsHandler, animater, options) {\r\n        this.hooks = new EventEmitter([\r\n            'start',\r\n            'beforeMove',\r\n            'scrollStart',\r\n            'scroll',\r\n            'beforeEnd',\r\n            'end',\r\n            'scrollEnd',\r\n            'contentNotMoved',\r\n            'detectMovingDirection',\r\n            'coordinateTransformation',\r\n        ]);\r\n        this.scrollBehaviorX = scrollBehaviorX;\r\n        this.scrollBehaviorY = scrollBehaviorY;\r\n        this.actionsHandler = actionsHandler;\r\n        this.animater = animater;\r\n        this.options = options;\r\n        this.directionLockAction = new DirectionLockAction(options.directionLockThreshold, options.freeScroll, options.eventPassthrough);\r\n        this.enabled = true;\r\n        this.bindActionsHandler();\r\n    }\r\n    ScrollerActions.prototype.bindActionsHandler = function () {\r\n        var _this = this;\r\n        // [mouse|touch]start event\r\n        this.actionsHandler.hooks.on(this.actionsHandler.hooks.eventTypes.start, function (e) {\r\n            if (!_this.enabled)\r\n                return true;\r\n            return _this.handleStart(e);\r\n        });\r\n        // [mouse|touch]move event\r\n        this.actionsHandler.hooks.on(this.actionsHandler.hooks.eventTypes.move, function (_a) {\r\n            var deltaX = _a.deltaX, deltaY = _a.deltaY, e = _a.e;\r\n            if (!_this.enabled)\r\n                return true;\r\n            var _b = applyQuadrantTransformation(deltaX, deltaY, _this.options.quadrant), transformateDeltaX = _b[0], transformateDeltaY = _b[1];\r\n            var transformateDeltaData = {\r\n                deltaX: transformateDeltaX,\r\n                deltaY: transformateDeltaY,\r\n            };\r\n            _this.hooks.trigger(_this.hooks.eventTypes.coordinateTransformation, transformateDeltaData);\r\n            return _this.handleMove(transformateDeltaData.deltaX, transformateDeltaData.deltaY, e);\r\n        });\r\n        // [mouse|touch]end event\r\n        this.actionsHandler.hooks.on(this.actionsHandler.hooks.eventTypes.end, function (e) {\r\n            if (!_this.enabled)\r\n                return true;\r\n            return _this.handleEnd(e);\r\n        });\r\n        // click\r\n        this.actionsHandler.hooks.on(this.actionsHandler.hooks.eventTypes.click, function (e) {\r\n            // handle native click event\r\n            if (_this.enabled && !e._constructed) {\r\n                _this.handleClick(e);\r\n            }\r\n        });\r\n    };\r\n    ScrollerActions.prototype.handleStart = function (e) {\r\n        var timestamp = getNow();\r\n        this.fingerMoved = false;\r\n        this.contentMoved = false;\r\n        this.startTime = timestamp;\r\n        this.directionLockAction.reset();\r\n        this.scrollBehaviorX.start();\r\n        this.scrollBehaviorY.start();\r\n        // force stopping last transition or animation\r\n        this.animater.doStop();\r\n        this.scrollBehaviorX.resetStartPos();\r\n        this.scrollBehaviorY.resetStartPos();\r\n        this.hooks.trigger(this.hooks.eventTypes.start, e);\r\n    };\r\n    ScrollerActions.prototype.handleMove = function (deltaX, deltaY, e) {\r\n        if (this.hooks.trigger(this.hooks.eventTypes.beforeMove, e)) {\r\n            return;\r\n        }\r\n        var absDistX = this.scrollBehaviorX.getAbsDist(deltaX);\r\n        var absDistY = this.scrollBehaviorY.getAbsDist(deltaY);\r\n        var timestamp = getNow();\r\n        // We need to move at least momentumLimitDistance pixels\r\n        // for the scrolling to initiate\r\n        if (this.checkMomentum(absDistX, absDistY, timestamp)) {\r\n            return true;\r\n        }\r\n        if (this.directionLockAction.checkMovingDirection(absDistX, absDistY, e)) {\r\n            this.actionsHandler.setInitiated();\r\n            return true;\r\n        }\r\n        var delta = this.directionLockAction.adjustDelta(deltaX, deltaY);\r\n        var prevX = this.scrollBehaviorX.getCurrentPos();\r\n        var newX = this.scrollBehaviorX.move(delta.deltaX);\r\n        var prevY = this.scrollBehaviorY.getCurrentPos();\r\n        var newY = this.scrollBehaviorY.move(delta.deltaY);\r\n        if (this.hooks.trigger(this.hooks.eventTypes.detectMovingDirection)) {\r\n            return;\r\n        }\r\n        if (!this.fingerMoved) {\r\n            this.fingerMoved = true;\r\n        }\r\n        var positionChanged = newX !== prevX || newY !== prevY;\r\n        if (!this.contentMoved && !positionChanged) {\r\n            this.hooks.trigger(this.hooks.eventTypes.contentNotMoved);\r\n        }\r\n        if (!this.contentMoved && positionChanged) {\r\n            this.contentMoved = true;\r\n            this.hooks.trigger(this.hooks.eventTypes.scrollStart);\r\n        }\r\n        if (this.contentMoved && positionChanged) {\r\n            this.animater.translate({\r\n                x: newX,\r\n                y: newY,\r\n            });\r\n            this.dispatchScroll(timestamp);\r\n        }\r\n    };\r\n    ScrollerActions.prototype.dispatchScroll = function (timestamp) {\r\n        // dispatch scroll in interval time\r\n        if (timestamp - this.startTime > this.options.momentumLimitTime) {\r\n            // refresh time and starting position to initiate a momentum\r\n            this.startTime = timestamp;\r\n            this.scrollBehaviorX.updateStartPos();\r\n            this.scrollBehaviorY.updateStartPos();\r\n            if (this.options.probeType === 1 /* Throttle */) {\r\n                this.hooks.trigger(this.hooks.eventTypes.scroll, this.getCurrentPos());\r\n            }\r\n        }\r\n        // dispatch scroll all the time\r\n        if (this.options.probeType > 1 /* Throttle */) {\r\n            this.hooks.trigger(this.hooks.eventTypes.scroll, this.getCurrentPos());\r\n        }\r\n    };\r\n    ScrollerActions.prototype.checkMomentum = function (absDistX, absDistY, timestamp) {\r\n        return (timestamp - this.endTime > this.options.momentumLimitTime &&\r\n            absDistY < this.options.momentumLimitDistance &&\r\n            absDistX < this.options.momentumLimitDistance);\r\n    };\r\n    ScrollerActions.prototype.handleEnd = function (e) {\r\n        if (this.hooks.trigger(this.hooks.eventTypes.beforeEnd, e)) {\r\n            return;\r\n        }\r\n        var currentPos = this.getCurrentPos();\r\n        this.scrollBehaviorX.updateDirection();\r\n        this.scrollBehaviorY.updateDirection();\r\n        if (this.hooks.trigger(this.hooks.eventTypes.end, e, currentPos)) {\r\n            return true;\r\n        }\r\n        currentPos = this.ensureIntegerPos(currentPos);\r\n        this.animater.translate(currentPos);\r\n        this.endTime = getNow();\r\n        var duration = this.endTime - this.startTime;\r\n        this.hooks.trigger(this.hooks.eventTypes.scrollEnd, currentPos, duration);\r\n    };\r\n    ScrollerActions.prototype.ensureIntegerPos = function (currentPos) {\r\n        this.ensuringInteger = true;\r\n        var x = currentPos.x, y = currentPos.y;\r\n        var _a = this.scrollBehaviorX, minScrollPosX = _a.minScrollPos, maxScrollPosX = _a.maxScrollPos;\r\n        var _b = this.scrollBehaviorY, minScrollPosY = _b.minScrollPos, maxScrollPosY = _b.maxScrollPos;\r\n        x = x > 0 ? Math.ceil(x) : Math.floor(x);\r\n        y = y > 0 ? Math.ceil(y) : Math.floor(y);\r\n        x = between(x, maxScrollPosX, minScrollPosX);\r\n        y = between(y, maxScrollPosY, minScrollPosY);\r\n        return { x: x, y: y };\r\n    };\r\n    ScrollerActions.prototype.handleClick = function (e) {\r\n        if (!preventDefaultExceptionFn(e.target, this.options.preventDefaultException)) {\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n        }\r\n    };\r\n    ScrollerActions.prototype.getCurrentPos = function () {\r\n        return {\r\n            x: this.scrollBehaviorX.getCurrentPos(),\r\n            y: this.scrollBehaviorY.getCurrentPos(),\r\n        };\r\n    };\r\n    ScrollerActions.prototype.refresh = function () {\r\n        this.endTime = 0;\r\n    };\r\n    ScrollerActions.prototype.destroy = function () {\r\n        this.hooks.destroy();\r\n    };\r\n    return ScrollerActions;\r\n}());\n\nfunction createActionsHandlerOptions(bsOptions) {\r\n    var options = [\r\n        'click',\r\n        'bindToWrapper',\r\n        'disableMouse',\r\n        'disableTouch',\r\n        'preventDefault',\r\n        'stopPropagation',\r\n        'tagException',\r\n        'preventDefaultException',\r\n        'autoEndDistance',\r\n    ].reduce(function (prev, cur) {\r\n        prev[cur] = bsOptions[cur];\r\n        return prev;\r\n    }, {});\r\n    return options;\r\n}\r\nfunction createBehaviorOptions(bsOptions, extraProp, bounces, rect) {\r\n    var options = [\r\n        'momentum',\r\n        'momentumLimitTime',\r\n        'momentumLimitDistance',\r\n        'deceleration',\r\n        'swipeBounceTime',\r\n        'swipeTime',\r\n        'outOfBoundaryDampingFactor',\r\n        'specifiedIndexAsContent',\r\n    ].reduce(function (prev, cur) {\r\n        prev[cur] = bsOptions[cur];\r\n        return prev;\r\n    }, {});\r\n    // add extra property\r\n    options.scrollable = !!bsOptions[extraProp];\r\n    options.bounces = bounces;\r\n    options.rect = rect;\r\n    return options;\r\n}\n\nfunction bubbling(source, target, events) {\r\n    events.forEach(function (event) {\r\n        var sourceEvent;\r\n        var targetEvent;\r\n        if (typeof event === 'string') {\r\n            sourceEvent = targetEvent = event;\r\n        }\r\n        else {\r\n            sourceEvent = event.source;\r\n            targetEvent = event.target;\r\n        }\r\n        source.on(sourceEvent, function () {\r\n            var args = [];\r\n            for (var _i = 0; _i < arguments.length; _i++) {\r\n                args[_i] = arguments[_i];\r\n            }\r\n            return target.trigger.apply(target, __spreadArrays([targetEvent], args));\r\n        });\r\n    });\r\n}\n\nfunction isSamePoint(startPoint, endPoint) {\r\n    // keys of startPoint and endPoint should be equal\r\n    var keys = Object.keys(startPoint);\r\n    for (var _i = 0, keys_1 = keys; _i < keys_1.length; _i++) {\r\n        var key = keys_1[_i];\r\n        if (startPoint[key] !== endPoint[key])\r\n            return false;\r\n    }\r\n    return true;\r\n}\n\nvar MIN_SCROLL_DISTANCE = 1;\r\nvar Scroller = /** @class */ (function () {\r\n    function Scroller(wrapper, content, options) {\r\n        this.wrapper = wrapper;\r\n        this.content = content;\r\n        this.resizeTimeout = 0;\r\n        this.hooks = new EventEmitter([\r\n            'beforeStart',\r\n            'beforeMove',\r\n            'beforeScrollStart',\r\n            'scrollStart',\r\n            'scroll',\r\n            'beforeEnd',\r\n            'scrollEnd',\r\n            'resize',\r\n            'touchEnd',\r\n            'end',\r\n            'flick',\r\n            'scrollCancel',\r\n            'momentum',\r\n            'scrollTo',\r\n            'minDistanceScroll',\r\n            'scrollToElement',\r\n            'beforeRefresh',\r\n        ]);\r\n        this.options = options;\r\n        var _a = this.options.bounce, left = _a.left, right = _a.right, top = _a.top, bottom = _a.bottom;\r\n        // direction X\r\n        this.scrollBehaviorX = new Behavior(wrapper, content, createBehaviorOptions(options, 'scrollX', [left, right], {\r\n            size: 'width',\r\n            position: 'left',\r\n        }));\r\n        // direction Y\r\n        this.scrollBehaviorY = new Behavior(wrapper, content, createBehaviorOptions(options, 'scrollY', [top, bottom], {\r\n            size: 'height',\r\n            position: 'top',\r\n        }));\r\n        this.translater = new Translater(this.content);\r\n        this.animater = createAnimater(this.content, this.translater, this.options);\r\n        this.actionsHandler = new ActionsHandler(this.options.bindToTarget ? this.content : wrapper, createActionsHandlerOptions(this.options));\r\n        this.actions = new ScrollerActions(this.scrollBehaviorX, this.scrollBehaviorY, this.actionsHandler, this.animater, this.options);\r\n        var resizeHandler = this.resize.bind(this);\r\n        this.resizeRegister = new EventRegister(window, [\r\n            {\r\n                name: 'orientationchange',\r\n                handler: resizeHandler,\r\n            },\r\n            {\r\n                name: 'resize',\r\n                handler: resizeHandler,\r\n            },\r\n        ]);\r\n        this.registerTransitionEnd();\r\n        this.init();\r\n    }\r\n    Scroller.prototype.init = function () {\r\n        var _this = this;\r\n        this.bindTranslater();\r\n        this.bindAnimater();\r\n        this.bindActions();\r\n        // enable pointer events when scrolling ends\r\n        this.hooks.on(this.hooks.eventTypes.scrollEnd, function () {\r\n            _this.togglePointerEvents(true);\r\n        });\r\n    };\r\n    Scroller.prototype.registerTransitionEnd = function () {\r\n        this.transitionEndRegister = new EventRegister(this.content, [\r\n            {\r\n                name: style.transitionEnd,\r\n                handler: this.transitionEnd.bind(this),\r\n            },\r\n        ]);\r\n    };\r\n    Scroller.prototype.bindTranslater = function () {\r\n        var _this = this;\r\n        var hooks = this.translater.hooks;\r\n        hooks.on(hooks.eventTypes.beforeTranslate, function (transformStyle) {\r\n            if (_this.options.translateZ) {\r\n                transformStyle.push(_this.options.translateZ);\r\n            }\r\n        });\r\n        // disable pointer events when scrolling\r\n        hooks.on(hooks.eventTypes.translate, function (pos) {\r\n            var prevPos = _this.getCurrentPos();\r\n            _this.updatePositions(pos);\r\n            // scrollEnd will dispatch when scroll is force stopping in touchstart handler\r\n            // so in touchend handler, don't toggle pointer-events\r\n            if (_this.actions.ensuringInteger === true) {\r\n                _this.actions.ensuringInteger = false;\r\n                return;\r\n            }\r\n            // a valid translate\r\n            if (pos.x !== prevPos.x || pos.y !== prevPos.y) {\r\n                _this.togglePointerEvents(false);\r\n            }\r\n        });\r\n    };\r\n    Scroller.prototype.bindAnimater = function () {\r\n        var _this = this;\r\n        // reset position\r\n        this.animater.hooks.on(this.animater.hooks.eventTypes.end, function (pos) {\r\n            if (!_this.resetPosition(_this.options.bounceTime)) {\r\n                _this.animater.setPending(false);\r\n                _this.hooks.trigger(_this.hooks.eventTypes.scrollEnd, pos);\r\n            }\r\n        });\r\n        bubbling(this.animater.hooks, this.hooks, [\r\n            {\r\n                source: this.animater.hooks.eventTypes.move,\r\n                target: this.hooks.eventTypes.scroll,\r\n            },\r\n            {\r\n                source: this.animater.hooks.eventTypes.forceStop,\r\n                target: this.hooks.eventTypes.scrollEnd,\r\n            },\r\n        ]);\r\n    };\r\n    Scroller.prototype.bindActions = function () {\r\n        var _this = this;\r\n        var actions = this.actions;\r\n        bubbling(actions.hooks, this.hooks, [\r\n            {\r\n                source: actions.hooks.eventTypes.start,\r\n                target: this.hooks.eventTypes.beforeStart,\r\n            },\r\n            {\r\n                source: actions.hooks.eventTypes.start,\r\n                target: this.hooks.eventTypes.beforeScrollStart,\r\n            },\r\n            {\r\n                source: actions.hooks.eventTypes.beforeMove,\r\n                target: this.hooks.eventTypes.beforeMove,\r\n            },\r\n            {\r\n                source: actions.hooks.eventTypes.scrollStart,\r\n                target: this.hooks.eventTypes.scrollStart,\r\n            },\r\n            {\r\n                source: actions.hooks.eventTypes.scroll,\r\n                target: this.hooks.eventTypes.scroll,\r\n            },\r\n            {\r\n                source: actions.hooks.eventTypes.beforeEnd,\r\n                target: this.hooks.eventTypes.beforeEnd,\r\n            },\r\n        ]);\r\n        actions.hooks.on(actions.hooks.eventTypes.end, function (e, pos) {\r\n            _this.hooks.trigger(_this.hooks.eventTypes.touchEnd, pos);\r\n            if (_this.hooks.trigger(_this.hooks.eventTypes.end, pos)) {\r\n                return true;\r\n            }\r\n            // check if it is a click operation\r\n            if (!actions.fingerMoved) {\r\n                _this.hooks.trigger(_this.hooks.eventTypes.scrollCancel);\r\n                if (_this.checkClick(e)) {\r\n                    return true;\r\n                }\r\n            }\r\n            // reset if we are outside of the boundaries\r\n            if (_this.resetPosition(_this.options.bounceTime, ease.bounce)) {\r\n                _this.animater.setForceStopped(false);\r\n                return true;\r\n            }\r\n        });\r\n        actions.hooks.on(actions.hooks.eventTypes.scrollEnd, function (pos, duration) {\r\n            var deltaX = Math.abs(pos.x - _this.scrollBehaviorX.startPos);\r\n            var deltaY = Math.abs(pos.y - _this.scrollBehaviorY.startPos);\r\n            if (_this.checkFlick(duration, deltaX, deltaY)) {\r\n                _this.animater.setForceStopped(false);\r\n                _this.hooks.trigger(_this.hooks.eventTypes.flick);\r\n                return;\r\n            }\r\n            if (_this.momentum(pos, duration)) {\r\n                _this.animater.setForceStopped(false);\r\n                return;\r\n            }\r\n            if (actions.contentMoved) {\r\n                _this.hooks.trigger(_this.hooks.eventTypes.scrollEnd, pos);\r\n            }\r\n            if (_this.animater.forceStopped) {\r\n                _this.animater.setForceStopped(false);\r\n            }\r\n        });\r\n    };\r\n    Scroller.prototype.checkFlick = function (duration, deltaX, deltaY) {\r\n        var flickMinMovingDistance = 1; // distinguish flick from click\r\n        if (this.hooks.events.flick.length > 1 &&\r\n            duration < this.options.flickLimitTime &&\r\n            deltaX < this.options.flickLimitDistance &&\r\n            deltaY < this.options.flickLimitDistance &&\r\n            (deltaY > flickMinMovingDistance || deltaX > flickMinMovingDistance)) {\r\n            return true;\r\n        }\r\n    };\r\n    Scroller.prototype.momentum = function (pos, duration) {\r\n        var meta = {\r\n            time: 0,\r\n            easing: ease.swiper,\r\n            newX: pos.x,\r\n            newY: pos.y,\r\n        };\r\n        // start momentum animation if needed\r\n        var momentumX = this.scrollBehaviorX.end(duration);\r\n        var momentumY = this.scrollBehaviorY.end(duration);\r\n        meta.newX = isUndef(momentumX.destination)\r\n            ? meta.newX\r\n            : momentumX.destination;\r\n        meta.newY = isUndef(momentumY.destination)\r\n            ? meta.newY\r\n            : momentumY.destination;\r\n        meta.time = Math.max(momentumX.duration, momentumY.duration);\r\n        this.hooks.trigger(this.hooks.eventTypes.momentum, meta, this);\r\n        // when x or y changed, do momentum animation now!\r\n        if (meta.newX !== pos.x || meta.newY !== pos.y) {\r\n            // change easing function when scroller goes out of the boundaries\r\n            if (meta.newX > this.scrollBehaviorX.minScrollPos ||\r\n                meta.newX < this.scrollBehaviorX.maxScrollPos ||\r\n                meta.newY > this.scrollBehaviorY.minScrollPos ||\r\n                meta.newY < this.scrollBehaviorY.maxScrollPos) {\r\n                meta.easing = ease.swipeBounce;\r\n            }\r\n            this.scrollTo(meta.newX, meta.newY, meta.time, meta.easing);\r\n            return true;\r\n        }\r\n    };\r\n    Scroller.prototype.checkClick = function (e) {\r\n        var cancelable = {\r\n            preventClick: this.animater.forceStopped,\r\n        };\r\n        // we scrolled less than momentumLimitDistance pixels\r\n        if (this.hooks.trigger(this.hooks.eventTypes.checkClick)) {\r\n            this.animater.setForceStopped(false);\r\n            return true;\r\n        }\r\n        if (!cancelable.preventClick) {\r\n            var _dblclick = this.options.dblclick;\r\n            var dblclickTrigged = false;\r\n            if (_dblclick && this.lastClickTime) {\r\n                var _a = _dblclick.delay, delay = _a === void 0 ? 300 : _a;\r\n                if (getNow() - this.lastClickTime < delay) {\r\n                    dblclickTrigged = true;\r\n                    dblclick(e);\r\n                }\r\n            }\r\n            if (this.options.tap) {\r\n                tap(e, this.options.tap);\r\n            }\r\n            if (this.options.click &&\r\n                !preventDefaultExceptionFn(e.target, this.options.preventDefaultException)) {\r\n                click(e);\r\n            }\r\n            this.lastClickTime = dblclickTrigged ? null : getNow();\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    Scroller.prototype.resize = function () {\r\n        var _this = this;\r\n        if (!this.actions.enabled) {\r\n            return;\r\n        }\r\n        // fix a scroll problem under Android condition\r\n        /* istanbul ignore if  */\r\n        if (isAndroid) {\r\n            this.wrapper.scrollTop = 0;\r\n        }\r\n        clearTimeout(this.resizeTimeout);\r\n        this.resizeTimeout = window.setTimeout(function () {\r\n            _this.hooks.trigger(_this.hooks.eventTypes.resize);\r\n        }, this.options.resizePolling);\r\n    };\r\n    /* istanbul ignore next */\r\n    Scroller.prototype.transitionEnd = function (e) {\r\n        if (e.target !== this.content || !this.animater.pending) {\r\n            return;\r\n        }\r\n        var animater = this.animater;\r\n        animater.transitionTime();\r\n        if (!this.resetPosition(this.options.bounceTime, ease.bounce)) {\r\n            this.animater.setPending(false);\r\n            if (this.options.probeType !== 3 /* Realtime */) {\r\n                this.hooks.trigger(this.hooks.eventTypes.scrollEnd, this.getCurrentPos());\r\n            }\r\n        }\r\n    };\r\n    Scroller.prototype.togglePointerEvents = function (enabled) {\r\n        if (enabled === void 0) { enabled = true; }\r\n        var el = this.content.children.length\r\n            ? this.content.children\r\n            : [this.content];\r\n        var pointerEvents = enabled ? 'auto' : 'none';\r\n        for (var i = 0; i < el.length; i++) {\r\n            var node = el[i];\r\n            // ignore BetterScroll instance's wrapper DOM\r\n            /* istanbul ignore if  */\r\n            if (node.isBScrollContainer) {\r\n                continue;\r\n            }\r\n            node.style.pointerEvents = pointerEvents;\r\n        }\r\n    };\r\n    Scroller.prototype.refresh = function (content) {\r\n        var contentChanged = this.setContent(content);\r\n        this.hooks.trigger(this.hooks.eventTypes.beforeRefresh);\r\n        this.scrollBehaviorX.refresh(content);\r\n        this.scrollBehaviorY.refresh(content);\r\n        if (contentChanged) {\r\n            this.translater.setContent(content);\r\n            this.animater.setContent(content);\r\n            this.transitionEndRegister.destroy();\r\n            this.registerTransitionEnd();\r\n            if (this.options.bindToTarget) {\r\n                this.actionsHandler.setContent(content);\r\n            }\r\n        }\r\n        this.actions.refresh();\r\n        this.wrapperOffset = offset(this.wrapper);\r\n    };\r\n    Scroller.prototype.setContent = function (content) {\r\n        var contentChanged = content !== this.content;\r\n        if (contentChanged) {\r\n            this.content = content;\r\n        }\r\n        return contentChanged;\r\n    };\r\n    Scroller.prototype.scrollBy = function (deltaX, deltaY, time, easing) {\r\n        if (time === void 0) { time = 0; }\r\n        var _a = this.getCurrentPos(), x = _a.x, y = _a.y;\r\n        easing = !easing ? ease.bounce : easing;\r\n        deltaX += x;\r\n        deltaY += y;\r\n        this.scrollTo(deltaX, deltaY, time, easing);\r\n    };\r\n    Scroller.prototype.scrollTo = function (x, y, time, easing, extraTransform) {\r\n        if (time === void 0) { time = 0; }\r\n        if (easing === void 0) { easing = ease.bounce; }\r\n        if (extraTransform === void 0) { extraTransform = {\r\n            start: {},\r\n            end: {},\r\n        }; }\r\n        var easingFn = this.options.useTransition ? easing.style : easing.fn;\r\n        var currentPos = this.getCurrentPos();\r\n        var startPoint = __assign({ x: currentPos.x, y: currentPos.y }, extraTransform.start);\r\n        var endPoint = __assign({ x: x,\r\n            y: y }, extraTransform.end);\r\n        this.hooks.trigger(this.hooks.eventTypes.scrollTo, endPoint);\r\n        // it is an useless move\r\n        if (isSamePoint(startPoint, endPoint))\r\n            return;\r\n        var deltaX = Math.abs(endPoint.x - startPoint.x);\r\n        var deltaY = Math.abs(endPoint.y - startPoint.y);\r\n        // considering of browser compatibility for decimal transform value\r\n        // force translating immediately\r\n        if (deltaX < MIN_SCROLL_DISTANCE && deltaY < MIN_SCROLL_DISTANCE) {\r\n            time = 0;\r\n            this.hooks.trigger(this.hooks.eventTypes.minDistanceScroll);\r\n        }\r\n        this.animater.move(startPoint, endPoint, time, easingFn);\r\n    };\r\n    Scroller.prototype.scrollToElement = function (el, time, offsetX, offsetY, easing) {\r\n        var targetEle = getElement(el);\r\n        var pos = offset(targetEle);\r\n        var getOffset = function (offset, size, wrapperSize) {\r\n            if (typeof offset === 'number') {\r\n                return offset;\r\n            }\r\n            // if offsetX/Y are true we center the element to the screen\r\n            return offset ? Math.round(size / 2 - wrapperSize / 2) : 0;\r\n        };\r\n        offsetX = getOffset(offsetX, targetEle.offsetWidth, this.wrapper.offsetWidth);\r\n        offsetY = getOffset(offsetY, targetEle.offsetHeight, this.wrapper.offsetHeight);\r\n        var getPos = function (pos, wrapperPos, offset, scrollBehavior) {\r\n            pos -= wrapperPos;\r\n            pos = scrollBehavior.adjustPosition(pos - offset);\r\n            return pos;\r\n        };\r\n        pos.left = getPos(pos.left, this.wrapperOffset.left, offsetX, this.scrollBehaviorX);\r\n        pos.top = getPos(pos.top, this.wrapperOffset.top, offsetY, this.scrollBehaviorY);\r\n        if (this.hooks.trigger(this.hooks.eventTypes.scrollToElement, targetEle, pos)) {\r\n            return;\r\n        }\r\n        this.scrollTo(pos.left, pos.top, time, easing);\r\n    };\r\n    Scroller.prototype.resetPosition = function (time, easing) {\r\n        if (time === void 0) { time = 0; }\r\n        if (easing === void 0) { easing = ease.bounce; }\r\n        var _a = this.scrollBehaviorX.checkInBoundary(), x = _a.position, xInBoundary = _a.inBoundary;\r\n        var _b = this.scrollBehaviorY.checkInBoundary(), y = _b.position, yInBoundary = _b.inBoundary;\r\n        if (xInBoundary && yInBoundary) {\r\n            return false;\r\n        }\r\n        /* istanbul ignore if  */\r\n        if (isIOSBadVersion) {\r\n            // fix ios 13.4 bouncing\r\n            // see it in issues 982\r\n            this.reflow();\r\n        }\r\n        // out of boundary\r\n        this.scrollTo(x, y, time, easing);\r\n        return true;\r\n    };\r\n    /* istanbul ignore next */\r\n    Scroller.prototype.reflow = function () {\r\n        this._reflow = this.content.offsetHeight;\r\n    };\r\n    Scroller.prototype.updatePositions = function (pos) {\r\n        this.scrollBehaviorX.updatePosition(pos.x);\r\n        this.scrollBehaviorY.updatePosition(pos.y);\r\n    };\r\n    Scroller.prototype.getCurrentPos = function () {\r\n        return this.actions.getCurrentPos();\r\n    };\r\n    Scroller.prototype.enable = function () {\r\n        this.actions.enabled = true;\r\n    };\r\n    Scroller.prototype.disable = function () {\r\n        cancelAnimationFrame(this.animater.timer);\r\n        this.actions.enabled = false;\r\n    };\r\n    Scroller.prototype.destroy = function () {\r\n        var _this = this;\r\n        var keys = [\r\n            'resizeRegister',\r\n            'transitionEndRegister',\r\n            'actionsHandler',\r\n            'actions',\r\n            'hooks',\r\n            'animater',\r\n            'translater',\r\n            'scrollBehaviorX',\r\n            'scrollBehaviorY',\r\n        ];\r\n        keys.forEach(function (key) { return _this[key].destroy(); });\r\n    };\r\n    return Scroller;\r\n}());\n\nvar BScrollConstructor = /** @class */ (function (_super) {\r\n    __extends(BScrollConstructor, _super);\r\n    function BScrollConstructor(el, options) {\r\n        var _this = _super.call(this, [\r\n            'refresh',\r\n            'contentChanged',\r\n            'enable',\r\n            'disable',\r\n            'beforeScrollStart',\r\n            'scrollStart',\r\n            'scroll',\r\n            'scrollEnd',\r\n            'scrollCancel',\r\n            'touchEnd',\r\n            'flick',\r\n            'destroy'\r\n        ]) || this;\r\n        var wrapper = getElement(el);\r\n        if (!wrapper) {\r\n            warn('Can not resolve the wrapper DOM.');\r\n            return _this;\r\n        }\r\n        _this.plugins = {};\r\n        _this.options = new OptionsConstructor().merge(options).process();\r\n        if (!_this.setContent(wrapper).valid) {\r\n            return _this;\r\n        }\r\n        _this.hooks = new EventEmitter([\r\n            'refresh',\r\n            'enable',\r\n            'disable',\r\n            'destroy',\r\n            'beforeInitialScrollTo',\r\n            'contentChanged'\r\n        ]);\r\n        _this.init(wrapper);\r\n        return _this;\r\n    }\r\n    BScrollConstructor.use = function (ctor) {\r\n        var name = ctor.pluginName;\r\n        var installed = BScrollConstructor.plugins.some(function (plugin) { return ctor === plugin.ctor; });\r\n        if (installed)\r\n            return BScrollConstructor;\r\n        if (isUndef(name)) {\r\n            warn(\"Plugin Class must specify plugin's name in static property by 'pluginName' field.\");\r\n            return BScrollConstructor;\r\n        }\r\n        BScrollConstructor.pluginsMap[name] = true;\r\n        BScrollConstructor.plugins.push({\r\n            name: name,\r\n            applyOrder: ctor.applyOrder,\r\n            ctor: ctor\r\n        });\r\n        return BScrollConstructor;\r\n    };\r\n    BScrollConstructor.prototype.setContent = function (wrapper) {\r\n        var contentChanged = false;\r\n        var valid = true;\r\n        var content = wrapper.children[this.options.specifiedIndexAsContent];\r\n        if (!content) {\r\n            warn('The wrapper need at least one child element to be content element to scroll.');\r\n            valid = false;\r\n        }\r\n        else {\r\n            contentChanged = this.content !== content;\r\n            if (contentChanged) {\r\n                this.content = content;\r\n            }\r\n        }\r\n        return {\r\n            valid: valid,\r\n            contentChanged: contentChanged\r\n        };\r\n    };\r\n    BScrollConstructor.prototype.init = function (wrapper) {\r\n        var _this = this;\r\n        this.wrapper = wrapper;\r\n        // mark wrapper to recognize bs instance by DOM attribute\r\n        wrapper.isBScrollContainer = true;\r\n        this.scroller = new Scroller(wrapper, this.content, this.options);\r\n        this.scroller.hooks.on(this.scroller.hooks.eventTypes.resize, function () {\r\n            _this.refresh();\r\n        });\r\n        this.eventBubbling();\r\n        this.handleAutoBlur();\r\n        this.enable();\r\n        this.proxy(propertiesConfig);\r\n        this.applyPlugins();\r\n        // maybe boundary has changed, should refresh\r\n        this.refreshWithoutReset(this.content);\r\n        var _a = this.options, startX = _a.startX, startY = _a.startY;\r\n        var position = {\r\n            x: startX,\r\n            y: startY\r\n        };\r\n        // maybe plugins want to control scroll position\r\n        if (this.hooks.trigger(this.hooks.eventTypes.beforeInitialScrollTo, position)) {\r\n            return;\r\n        }\r\n        this.scroller.scrollTo(position.x, position.y);\r\n    };\r\n    BScrollConstructor.prototype.applyPlugins = function () {\r\n        var _this = this;\r\n        var options = this.options;\r\n        BScrollConstructor.plugins\r\n            .sort(function (a, b) {\r\n            var _a;\r\n            var applyOrderMap = (_a = {},\r\n                _a[\"pre\" /* Pre */] = -1,\r\n                _a[\"post\" /* Post */] = 1,\r\n                _a);\r\n            var aOrder = a.applyOrder ? applyOrderMap[a.applyOrder] : 0;\r\n            var bOrder = b.applyOrder ? applyOrderMap[b.applyOrder] : 0;\r\n            return aOrder - bOrder;\r\n        })\r\n            .forEach(function (item) {\r\n            var ctor = item.ctor;\r\n            if (options[item.name] && typeof ctor === 'function') {\r\n                _this.plugins[item.name] = new ctor(_this);\r\n            }\r\n        });\r\n    };\r\n    BScrollConstructor.prototype.handleAutoBlur = function () {\r\n        /* istanbul ignore if  */\r\n        if (this.options.autoBlur) {\r\n            this.on(this.eventTypes.beforeScrollStart, function () {\r\n                var activeElement = document.activeElement;\r\n                if (activeElement &&\r\n                    (activeElement.tagName === 'INPUT' ||\r\n                        activeElement.tagName === 'TEXTAREA')) {\r\n                    activeElement.blur();\r\n                }\r\n            });\r\n        }\r\n    };\r\n    BScrollConstructor.prototype.eventBubbling = function () {\r\n        bubbling(this.scroller.hooks, this, [\r\n            this.eventTypes.beforeScrollStart,\r\n            this.eventTypes.scrollStart,\r\n            this.eventTypes.scroll,\r\n            this.eventTypes.scrollEnd,\r\n            this.eventTypes.scrollCancel,\r\n            this.eventTypes.touchEnd,\r\n            this.eventTypes.flick\r\n        ]);\r\n    };\r\n    BScrollConstructor.prototype.refreshWithoutReset = function (content) {\r\n        this.scroller.refresh(content);\r\n        this.hooks.trigger(this.hooks.eventTypes.refresh, content);\r\n        this.trigger(this.eventTypes.refresh, content);\r\n    };\r\n    BScrollConstructor.prototype.proxy = function (propertiesConfig) {\r\n        var _this = this;\r\n        propertiesConfig.forEach(function (_a) {\r\n            var key = _a.key, sourceKey = _a.sourceKey;\r\n            propertiesProxy(_this, sourceKey, key);\r\n        });\r\n    };\r\n    BScrollConstructor.prototype.refresh = function () {\r\n        var _a = this.setContent(this.wrapper), contentChanged = _a.contentChanged, valid = _a.valid;\r\n        if (valid) {\r\n            var content = this.content;\r\n            this.refreshWithoutReset(content);\r\n            if (contentChanged) {\r\n                this.hooks.trigger(this.hooks.eventTypes.contentChanged, content);\r\n                this.trigger(this.eventTypes.contentChanged, content);\r\n            }\r\n            this.scroller.resetPosition();\r\n        }\r\n    };\r\n    BScrollConstructor.prototype.enable = function () {\r\n        this.scroller.enable();\r\n        this.hooks.trigger(this.hooks.eventTypes.enable);\r\n        this.trigger(this.eventTypes.enable);\r\n    };\r\n    BScrollConstructor.prototype.disable = function () {\r\n        this.scroller.disable();\r\n        this.hooks.trigger(this.hooks.eventTypes.disable);\r\n        this.trigger(this.eventTypes.disable);\r\n    };\r\n    BScrollConstructor.prototype.destroy = function () {\r\n        this.hooks.trigger(this.hooks.eventTypes.destroy);\r\n        this.trigger(this.eventTypes.destroy);\r\n        this.scroller.destroy();\r\n    };\r\n    BScrollConstructor.prototype.eventRegister = function (names) {\r\n        this.registerType(names);\r\n    };\r\n    BScrollConstructor.plugins = [];\r\n    BScrollConstructor.pluginsMap = {};\r\n    return BScrollConstructor;\r\n}(EventEmitter));\r\nfunction createBScroll(el, options) {\r\n    var bs = new BScrollConstructor(el, options);\r\n    return bs;\r\n}\r\ncreateBScroll.use = BScrollConstructor.use;\r\ncreateBScroll.plugins = BScrollConstructor.plugins;\r\ncreateBScroll.pluginsMap = BScrollConstructor.pluginsMap;\r\nvar BScroll = createBScroll;\n\nexport default BScroll;\nexport { Behavior, CustomOptions, createBScroll };\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}